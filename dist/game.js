
/* Zork Data */
const objectsData = {
    "#####": {
        "id": "#####",
        "name": "cretin",
        "description": "You are here",
        "initialDescription": "",
        "flags": 0,
        "properties": {
            "function": "OVISON"
        },
        "synonyms": [],
        "adjectives": []
    },
    "SBAG": {
        "id": "SBAG",
        "name": "sandwich bag",
        "description": "A sandwich bag is here.",
        "initialDescription": "On the table is an elongated brown sack, smelling of hot peppers.",
        "flags": 67125265,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "GARLI": {
        "id": "GARLI",
        "name": "clove of garlic",
        "description": "There is a clove of garlic here.",
        "initialDescription": "",
        "flags": 18433,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "FOOD": {
        "id": "FOOD",
        "name": "\\.lunch",
        "description": "A hot pepper sandwich is here.",
        "initialDescription": "",
        "flags": 18433,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "GUNK": {
        "id": "GUNK",
        "name": "piece of vitreous slag",
        "description": "There is a small piece of vitreous slag here.",
        "initialDescription": "",
        "flags": 16793601,
        "properties": {
            "function": "GUNK-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "COAL": {
        "id": "COAL",
        "name": "small pile of coal",
        "description": "There is a small heap of coal here.",
        "initialDescription": "",
        "flags": 16417,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "JADE": {
        "id": "JADE",
        "name": "jade figurine",
        "description": "There is an exquisite jade figurine here.",
        "initialDescription": "",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "MACHI": {
        "id": "MACHI",
        "name": "machine",
        "description": "",
        "initialDescription": "",
        "flags": 16400,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "DIAMO": {
        "id": "DIAMO",
        "name": "huge diamond",
        "description": "There is an enormous diamond (perfectly cut) here.",
        "initialDescription": "",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "TCASE": {
        "id": "TCASE",
        "name": "trophy case",
        "description": "There is a trophy case here.",
        "initialDescription": "",
        "flags": 33570832,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BOTTL": {
        "id": "BOTTL",
        "name": "glass bottle",
        "description": "A clear glass bottle is here.",
        "initialDescription": "A bottle is sitting on the table.",
        "flags": 33570833,
        "properties": {
            "function": "BOTTLE-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "WATER": {
        "id": "WATER",
        "name": "quantity of water",
        "description": "Water",
        "initialDescription": "There is some water here",
        "flags": 17409,
        "properties": {
            "function": "WATER-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "ROPE": {
        "id": "ROPE",
        "name": "rope",
        "description": "There is a large coil of rope here.",
        "initialDescription": "A large coil of rope is lying in the corner.",
        "flags": 20481,
        "properties": {
            "function": "ROPE-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "KNIFE": {
        "id": "KNIFE",
        "name": "knife",
        "description": "There is a nasty-looking knife lying here.",
        "initialDescription": "On a table is a nasty-looking knife.",
        "flags": 16449,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "SWORD": {
        "id": "SWORD",
        "name": "sword",
        "description": "There is an elvish sword here.",
        "initialDescription": "On hooks above the mantelpiece hangs an elvish sword of great\nantiquity.",
        "flags": 16449,
        "properties": {
            "function": "SWORD"
        },
        "synonyms": [],
        "adjectives": []
    },
    "LAMP": {
        "id": "LAMP",
        "name": "lamp",
        "description": "There is a brass lantern (battery-powered) here.",
        "initialDescription": "A battery-powered brass lantern is on the trophy case.",
        "flags": 16385,
        "properties": {
            "function": "-1"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BLAMP": {
        "id": "BLAMP",
        "name": "broken lamp",
        "description": "There is a broken brass lantern here.",
        "initialDescription": "",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "RUG": {
        "id": "RUG",
        "name": "carpet",
        "description": "",
        "initialDescription": "",
        "flags": 25182208,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "LEAVE": {
        "id": "LEAVE",
        "name": "pile of leaves",
        "description": "There is a pile of leaves on the ground.",
        "initialDescription": "",
        "flags": 16417,
        "properties": {
            "function": "LEAF-PILE"
        },
        "synonyms": [],
        "adjectives": []
    },
    "TROLL": {
        "id": "TROLL",
        "name": "",
        "description": "",
        "initialDescription": "",
        "flags": 114688,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "AXE": {
        "id": "AXE",
        "name": "bloody axe",
        "description": "There is a bloody axe here.",
        "initialDescription": "",
        "flags": 16448,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "RKNIF": {
        "id": "RKNIF",
        "name": "rusty knife",
        "description": "There is a rusty knife here.",
        "initialDescription": "Beside the skeleton is a rusty knife.",
        "flags": 16449,
        "properties": {
            "function": "RUSTY-KNIFE"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BLANT": {
        "id": "BLANT",
        "name": "burned-out lantern",
        "description": "There is a burned-out lantern here.",
        "initialDescription": "The deceased adventurer's useless lantern is here.",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "KEYS": {
        "id": "KEYS",
        "name": "set of skeleton keys",
        "description": "There is a set of skeleton keys here.",
        "initialDescription": "",
        "flags": 16897,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "BONES": {
        "id": "BONES",
        "name": "",
        "description": "A skeleton, probably the remains of a luckless adventurer, lies here.",
        "initialDescription": "",
        "flags": 16793600,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BAGCO": {
        "id": "BAGCO",
        "name": "bag of coins",
        "description": "An old leather bag, bulging with coins, is here.",
        "initialDescription": "",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "BAR": {
        "id": "BAR",
        "name": "platinum bar",
        "description": "There is a large platinum bar here.",
        "initialDescription": "",
        "flags": 16641,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "PEARL": {
        "id": "PEARL",
        "name": "pearl necklace",
        "description": "There is a pearl necklace here with hundreds of large pearls.",
        "initialDescription": "",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "REFL1": {
        "id": "REFL1",
        "name": "mirror",
        "description": "",
        "initialDescription": "",
        "flags": 16859136,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "REFL2": {
        "id": "REFL2",
        "name": "mirror",
        "description": "",
        "initialDescription": "",
        "flags": 16859136,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "ICE": {
        "id": "ICE",
        "name": "glacier",
        "description": "A mass of ice fills the western half of the room.",
        "initialDescription": "",
        "flags": 81920,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "RUBY": {
        "id": "RUBY",
        "name": "ruby",
        "description": "There is a moby ruby lying here.",
        "initialDescription": "On the floor lies a moby ruby.",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "TRIDE": {
        "id": "TRIDE",
        "name": "crystal trident",
        "description": "Neptune's own crystal trident is here.",
        "initialDescription": "On the shore lies Neptune's own crystal trident.",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "COFFI": {
        "id": "COFFI",
        "name": "gold coffin",
        "description": "There is a solid-gold coffin, used for the burial of Ramses II, here.",
        "initialDescription": "",
        "flags": 16657,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "TORCH": {
        "id": "TORCH",
        "name": "torch",
        "description": "There is an ivory torch here.",
        "initialDescription": "Sitting on the pedestal is a flaming torch, made of ivory.",
        "flags": 67125761,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "TBASK": {
        "id": "TBASK",
        "name": "basket",
        "description": "At the end of the chain is a basket.",
        "initialDescription": "",
        "flags": 33570832,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "FBASK": {
        "id": "FBASK",
        "name": "",
        "description": "",
        "initialDescription": "",
        "flags": 0,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BRACE": {
        "id": "BRACE",
        "name": "sapphire bracelet",
        "description": "There is a sapphire-encrusted bracelet here.",
        "initialDescription": "",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "IRBOX": {
        "id": "IRBOX",
        "name": "iron box",
        "description": "There is a dented iron box here.",
        "initialDescription": "",
        "flags": 17,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "STRAD": {
        "id": "STRAD",
        "name": "fancy violin",
        "description": "There is a Stradavarius here.",
        "initialDescription": "",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "GHOST": {
        "id": "GHOST",
        "name": "",
        "description": "",
        "initialDescription": "",
        "flags": 81920,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "GRAIL": {
        "id": "GRAIL",
        "name": "grail",
        "description": "There is an extremely valuable (perhaps original) grail here.",
        "initialDescription": "",
        "flags": 16401,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "TRUNK": {
        "id": "TRUNK",
        "name": "trunk with jewels",
        "description": "There is an old trunk here, bulging with assorted jewels.",
        "initialDescription": "Lying half buried in the mud is an old trunk, bulging with jewels.",
        "flags": 0,
        "properties": {
            "function": "TAKEBIT"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BELL": {
        "id": "BELL",
        "name": "bell",
        "description": "There is a small brass bell here.",
        "initialDescription": "Lying in a corner of the room is a small brass bell.",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "BOOK": {
        "id": "BOOK",
        "name": "book",
        "description": "There is a large black book here.",
        "initialDescription": "On the altar is a large black book, open to page 569.",
        "flags": 16545,
        "properties": {
            "function": "BLACK-BOOK"
        },
        "synonyms": [],
        "adjectives": []
    },
    "CANDL": {
        "id": "CANDL",
        "name": "pair of candles",
        "description": "There are two candles here.",
        "initialDescription": "On the two ends of the altar are burning candles.",
        "flags": 67125249,
        "properties": {
            "function": "CANDLES"
        },
        "synonyms": [],
        "adjectives": []
    },
    "GUIDE": {
        "id": "GUIDE",
        "name": "tour guidebook",
        "description": "There are tour guidebooks here.",
        "initialDescription": "Some guidebooks entitled 'Flood Control Dam #3' are on the reception\ndesk.",
        "flags": 16545,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "PAPER": {
        "id": "PAPER",
        "name": "newspaper",
        "description": "",
        "initialDescription": "",
        "flags": 16545,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "MATCH": {
        "id": "MATCH",
        "name": "matchbook",
        "description": "There is a matchbook whose cover says 'Visit Beautiful FCD#3' here.",
        "initialDescription": "",
        "flags": 16513,
        "properties": {
            "function": "MATCH-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "ADVER": {
        "id": "ADVER",
        "name": "leaflet",
        "description": "There is a small leaflet here.",
        "initialDescription": "",
        "flags": 16545,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "MAILB": {
        "id": "MAILB",
        "name": "mailbox",
        "description": "There is a small mailbox here.",
        "initialDescription": "",
        "flags": 16400,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "TUBE": {
        "id": "TUBE",
        "name": "tube",
        "description": "There is an object which looks like a tube of toothpaste here.",
        "initialDescription": "",
        "flags": 16401,
        "properties": {
            "function": "TUBE-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "PUTTY": {
        "id": "PUTTY",
        "name": "viscous material",
        "description": "There is some gunk here",
        "initialDescription": "",
        "flags": 16897,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "WRENC": {
        "id": "WRENC",
        "name": "wrench",
        "description": "There is a wrench here.",
        "initialDescription": "",
        "flags": 16897,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "SCREW": {
        "id": "SCREW",
        "name": "screwdriver",
        "description": "There is a screwdriver here.",
        "initialDescription": "",
        "flags": 16897,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "CYCLO": {
        "id": "CYCLO",
        "name": "cyclops",
        "description": "",
        "initialDescription": "",
        "flags": 114688,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "CHALI": {
        "id": "CHALI",
        "name": "chalice",
        "description": "There is a silver chalice, intricately engraved, here.",
        "initialDescription": "",
        "flags": 16401,
        "properties": {
            "function": "CHALICE"
        },
        "synonyms": [],
        "adjectives": []
    },
    "PAINT": {
        "id": "PAINT",
        "name": "painting",
        "description": "A masterpiece by a neglected genius is here.",
        "initialDescription": "Fortunately, there is still one chance for you to be a vandal, for on\nthe far wall is a work of unparalleled beauty.",
        "flags": 16417,
        "properties": {
            "function": "PAINTING"
        },
        "synonyms": [],
        "adjectives": []
    },
    "THIEF": {
        "id": "THIEF",
        "name": "",
        "description": "",
        "initialDescription": "",
        "flags": 114688,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "STILL": {
        "id": "STILL",
        "name": "stilletto",
        "description": "There is a vicious-looking stilletto here.",
        "initialDescription": "",
        "flags": 16448,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "POT": {
        "id": "POT",
        "name": "pot filled with gold",
        "description": "There is a pot of gold here.",
        "initialDescription": "At the end of the rainbow is a pot of gold.",
        "flags": 0,
        "properties": {
            "function": "TAKEBIT"
        },
        "synonyms": [],
        "adjectives": []
    },
    "STATU": {
        "id": "STATU",
        "name": "statue",
        "description": "There is a beautiful statue here.",
        "initialDescription": "",
        "flags": 0,
        "properties": {
            "function": "TAKEBIT"
        },
        "synonyms": [],
        "adjectives": []
    },
    "IBOAT": {
        "id": "IBOAT",
        "name": "plastic inflatable boat",
        "description": "There is a folded pile of plastic here which has a small valve\nattached.",
        "initialDescription": "",
        "flags": 16417,
        "properties": {
            "function": "IBOAT-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "DBOAT": {
        "id": "DBOAT",
        "name": "plastic boat (with hole)",
        "description": "There is a pile of plastic here with a large hole in it.",
        "initialDescription": "",
        "flags": 16417,
        "properties": {
            "function": "DBOAT-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "PUMP": {
        "id": "PUMP",
        "name": "hand-held air pump",
        "description": "There is a small pump here.",
        "initialDescription": "",
        "flags": 16897,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "RBOAT": {
        "id": "RBOAT",
        "name": "magic boat",
        "description": "There is an inflated boat here.",
        "initialDescription": "",
        "flags": 24609,
        "properties": {
            "function": "RBOAT-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "LABEL": {
        "id": "LABEL",
        "name": "tan label",
        "description": "There is a tan label here.",
        "initialDescription": "",
        "flags": 16545,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "STICK": {
        "id": "STICK",
        "name": "broken sharp stick",
        "description": "There is a broken sharp stick here.",
        "initialDescription": "A sharp stick, which appears to have been broken at one end, is here.",
        "flags": 16385,
        "properties": {
            "function": "STICK-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BUOY": {
        "id": "BUOY",
        "name": "red buoy",
        "description": "There is a red buoy here (probably a warning).",
        "initialDescription": "",
        "flags": 134234129,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "EMERA": {
        "id": "EMERA",
        "name": "large emerald",
        "description": "There is an emerald here.",
        "initialDescription": "",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "SHOVE": {
        "id": "SHOVE",
        "name": "shovel",
        "description": "There is a large shovel here.",
        "initialDescription": "",
        "flags": 16897,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "GUANO": {
        "id": "GUANO",
        "name": "hunk of bat guano",
        "description": "There is a hunk of bat guano here.",
        "initialDescription": "",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "GRUE": {
        "id": "GRUE",
        "name": "lurking grue",
        "description": "",
        "initialDescription": "",
        "flags": 0,
        "properties": {
            "function": "OVISON"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BALLO": {
        "id": "BALLO",
        "name": "basket",
        "description": "There is a very large and extremely heavy wicker basket with a cloth\nbag here. Inside the basket is a metal receptacle of some kind. \nAttached to the basket on the outside is a piece of wire.",
        "initialDescription": "",
        "flags": 24576,
        "properties": {
            "function": "BALLOON"
        },
        "synonyms": [],
        "adjectives": []
    },
    "RECEP": {
        "id": "RECEP",
        "name": "receptacle",
        "description": "",
        "initialDescription": "",
        "flags": 278544,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "CBAG": {
        "id": "CBAG",
        "name": "cloth bag",
        "description": "",
        "initialDescription": "",
        "flags": 0,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BROPE": {
        "id": "BROPE",
        "name": "braided wire",
        "description": "",
        "initialDescription": "",
        "flags": 20480,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "HOOK1": {
        "id": "HOOK1",
        "name": "hook",
        "description": "There is a small hook attached to the rock here.",
        "initialDescription": "",
        "flags": 0,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "HOOK2": {
        "id": "HOOK2",
        "name": "hook",
        "description": "There is a small hook attached to the rock here.",
        "initialDescription": "",
        "flags": 0,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "ZORKM": {
        "id": "ZORKM",
        "name": "priceless zorkmid",
        "description": "There is an engraved zorkmid coin here.",
        "initialDescription": "On the floor is a gold zorkmid coin (a valuable collector's item).",
        "flags": 16513,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "WDOOR": {
        "id": "WDOOR",
        "name": "door",
        "description": "The door is closed.",
        "initialDescription": "",
        "flags": 2,
        "properties": {},
        "synonyms": ["door"],
        "adjectives": ["wooden"]
    },
    "DOOR": {
        "id": "DOOR",
        "name": "door",
        "description": "The door is closed.",
        "initialDescription": "",
        "flags": 2,
        "properties": {},
        "synonyms": ["door"],
        "adjectives": []
    },
    "WIND2": {
        "id": "WIND2",
        "name": "window",
        "description": "There is a small window here, which is open.",
        "initialDescription": "",
        "flags": 2,
        "properties": {},
        "synonyms": ["window"],
        "adjectives": ["small"]
    },
    "SAFE": {
        "id": "SAFE",
        "name": "box",
        "description": "",
        "initialDescription": "",
        "flags": 16400,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "CARD": {
        "id": "CARD",
        "name": "card",
        "description": "There is a card with writing on it here.",
        "initialDescription": "",
        "flags": 16545,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "SSLOT": {
        "id": "SSLOT",
        "name": "hole",
        "description": "",
        "initialDescription": "",
        "flags": 0,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "CROWN": {
        "id": "CROWN",
        "name": "crown",
        "description": "Lord Dimwit's crown is here.",
        "initialDescription": "The excessively gaudy crown of Lord Dimwit Flathead is here.",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "BRICK": {
        "id": "BRICK",
        "name": "brick",
        "description": "There is a square brick here which feels like clay.",
        "initialDescription": "",
        "flags": 278561,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "FUSE": {
        "id": "FUSE",
        "name": "wire coil",
        "description": "There is a coil of thin shiny wire here.",
        "initialDescription": "",
        "flags": 16417,
        "properties": {
            "function": "FUSE-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "GNOME": {
        "id": "GNOME",
        "name": "Volcano Gnome",
        "description": "There is a nervous Volcano Gnome here.",
        "initialDescription": "",
        "flags": 81920,
        "properties": {
            "function": "BIGFIX"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BLABE": {
        "id": "BLABE",
        "name": "blue label",
        "description": "There is a blue label here.",
        "initialDescription": "",
        "flags": 16545,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "DBALL": {
        "id": "DBALL",
        "name": "broken balloon",
        "description": "There is a balloon here, broken into pieces.",
        "initialDescription": "",
        "flags": 16385,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "BLBK": {
        "id": "BLBK",
        "name": "blue book",
        "description": "There is a blue book here.",
        "initialDescription": "",
        "flags": 16529,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "GRBK": {
        "id": "GRBK",
        "name": "green book",
        "description": "There is a green book here.",
        "initialDescription": "",
        "flags": 16529,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "PUBK": {
        "id": "PUBK",
        "name": "purple book",
        "description": "There is a purple book here.",
        "initialDescription": "",
        "flags": 16529,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "WHBK": {
        "id": "WHBK",
        "name": "white book",
        "description": "There is a white book here.",
        "initialDescription": "",
        "flags": 16529,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "STAMP": {
        "id": "STAMP",
        "name": "stamp",
        "description": "There is a Flathead Commemorative stamp here.",
        "initialDescription": "",
        "flags": 16545,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "TOMB": {
        "id": "TOMB",
        "name": "tomb",
        "description": "There is a tomb here, made of the finest marble, and large enough\nfor four headless corpses.  On one end is the cryptic inscription:\n\t\t    \n\t\t      \\Feel Free.\\\n",
        "initialDescription": "",
        "flags": 16793728,
        "properties": {
            "function": "HEAD-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "HEADS": {
        "id": "HEADS",
        "name": "set of poled heads",
        "description": "There are four heads here, mounted securely on poles.",
        "initialDescription": "",
        "flags": 16793856,
        "properties": {
            "function": "HEAD-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "COKES": {
        "id": "COKES",
        "name": "bunch of Coke bottles",
        "description": "Many empty Coke bottles are here.  Alas, they can't hold water.",
        "initialDescription": "There is a large pile of empty Coke bottles here, evidently produced\nby the implementers during their long struggle to win totally.",
        "flags": 16385,
        "properties": {
            "function": "COKE-BOTTLES"
        },
        "synonyms": [],
        "adjectives": []
    },
    "LISTS": {
        "id": "LISTS",
        "name": "stack of listings",
        "description": "There is an enormous stack of line-printer paper here.  It is barely\nreadable.",
        "initialDescription": "There is a gigantic pile of line-printer output here.  Although the\npaper once contained useful information, almost nothing can be\ndistinguished now.",
        "flags": 16545,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "LCASE": {
        "id": "LCASE",
        "name": "large case",
        "description": "There is a large case here, containing objects which you used to\npossess.",
        "initialDescription": "",
        "flags": 33570816,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "CAGE": {
        "id": "CAGE",
        "name": "mangled cage",
        "description": "There is a mangled cage here.",
        "initialDescription": "",
        "flags": 8404992,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "RCAGE": {
        "id": "RCAGE",
        "name": "iron cage",
        "description": "There is an iron cage in the middle of the room.",
        "initialDescription": "",
        "flags": 0,
        "properties": {
            "function": "OVISON"
        },
        "synonyms": [],
        "adjectives": []
    },
    "SPHER": {
        "id": "SPHER",
        "name": "crystal sphere",
        "description": "There is a beautiful crystal sphere here.",
        "initialDescription": "",
        "flags": 16793856,
        "properties": {
            "function": "SPHERE-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "FLASK": {
        "id": "FLASK",
        "name": "glass flask filled with liquid",
        "description": "A stoppered glass flask with a skull-and-crossbones marking is here.\nThe flask is filled with some clear liquid.",
        "initialDescription": "",
        "flags": 33570817,
        "properties": {
            "function": "FLASK-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "POOL": {
        "id": "POOL",
        "name": "pool of sewage",
        "description": "The leak has submerged the depressed area in a pool of sewage.",
        "initialDescription": "",
        "flags": 81920,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "SAFFR": {
        "id": "SAFFR",
        "name": "tin of spices",
        "description": "There is a tin of rare spices here.",
        "initialDescription": "",
        "flags": 0,
        "properties": {
            "function": "TAKEBIT"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BUCKE": {
        "id": "BUCKE",
        "name": "wooden bucket",
        "description": "There is a wooden bucket here, 3 feet in diameter and 3 feet high.",
        "initialDescription": "",
        "flags": 24576,
        "properties": {
            "function": "BUCKET"
        },
        "synonyms": [],
        "adjectives": []
    },
    "ECAKE": {
        "id": "ECAKE",
        "name": "piece of 'Eat Me' cake",
        "description": "There is a piece of cake here with the words 'Eat Me' on it.",
        "initialDescription": "",
        "flags": 18433,
        "properties": {
            "function": "EATME-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "ORICE": {
        "id": "ORICE",
        "name": "piece of cake with orange icing",
        "description": "There is a piece of cake with orange icing here.",
        "initialDescription": "",
        "flags": 18561,
        "properties": {
            "function": "CAKE-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "RDICE": {
        "id": "RDICE",
        "name": "piece of cake with red icing",
        "description": "There is a piece of cake with red icing here.",
        "initialDescription": "",
        "flags": 18561,
        "properties": {
            "function": "CAKE-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "BLICE": {
        "id": "BLICE",
        "name": "piece of cake with blue icing",
        "description": "There is a piece of cake with blue (ecch) icing here.",
        "initialDescription": "",
        "flags": 18561,
        "properties": {
            "function": "CAKE-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "ROBOT": {
        "id": "ROBOT",
        "name": "robot",
        "description": "There is a robot here.",
        "initialDescription": "",
        "flags": 536953088,
        "properties": {
            "function": "ROBOT-FUNCTION"
        },
        "synonyms": [],
        "adjectives": []
    },
    "RBTLB": {
        "id": "RBTLB",
        "name": "green piece of paper",
        "description": "There is a green piece of paper here.",
        "initialDescription": "",
        "flags": 16545,
        "properties": {},
        "synonyms": [],
        "adjectives": []
    },
    "WIND1": {
        "id": "WIND1",
        "name": "window",
        "description": "There is a small window here.",
        "initialDescription": "There is a small window here.",
        "flags": 2,
        "properties": {},
        "synonyms": ["window"],
        "adjectives": ["small"]
    },
    "TRAP-DOOR": {
        "id": "TRAP-DOOR",
        "name": "trap door",
        "description": "There is a trap door here.",
        "initialDescription": "The dusty cover of a closed trap door is here.",
        "flags": 8388610,
        "properties": {},
        "synonyms": ["trapdoor", "door"],
        "adjectives": ["trap"]
    },
    "TDOOR": {
        "id": "TDOOR",
        "name": "trap door",
        "description": "A dusty trap door is here, obviously closed.",
        "initialDescription": "A dusty trap door is here, obviously closed.",
        "flags": 2,
        "properties": {},
        "synonyms": ["trapdoor", "door"],
        "adjectives": ["trap"]
    },
    "GRAT2": {
        "id": "GRAT2",
        "name": "grating",
        "description": "There is a grating here.",
        "initialDescription": "There is a grating here.",
        "flags": 8,
        "properties": {},
        "synonyms": ["grate"],
        "adjectives": []
    }
};
const roomsData = {
    "PASS1": {
        "id": "PASS1",
        "shortDesc": "East-West Passage",
        "longDesc": "You are in a narrow east-west passageway.  There is a narrow stairway\nleading down at the north end of the room.",
        "exits": {
            "EAST": "CAROU",
            "WEST": "MTROL",
            "DOWN": "RAVI1",
            "NORTH": "RAVI1"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "WHOUS": {
        "id": "WHOUS",
        "shortDesc": "West of House",
        "longDesc": "You are in an open field west of a big white house, with a boarded\nfront door.",
        "exits": {
            "NORTH": "NHOUS",
            "SOUTH": "SHOUS",
            "WEST": "FORE1",
            "EAST": {
                "blocked": "The door is locked, and there is evidently no key."
            }
        },
        "objects": [
            "FDOOR",
            "MAILB"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "NHOUS": {
        "id": "NHOUS",
        "shortDesc": "North of House",
        "longDesc": "You are facing the north side of a white house.  There is no door here,\nand all the windows are barred.",
        "exits": {
            "WEST": "WHOUS",
            "EAST": "EHOUS",
            "NORTH": "FORE3",
            "SOUTH": {
                "blocked": "The windows are all barred."
            }
        },
        "objects": [],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "SHOUS": {
        "id": "SHOUS",
        "shortDesc": "South of House",
        "longDesc": "You are facing the south side of a white house. There is no door here,\nand all the windows are barred.",
        "exits": {
            "WEST": "WHOUS",
            "EAST": "EHOUS",
            "SOUTH": "FORE2",
            "NORTH": {
                "blocked": "The windows are all barred."
            }
        },
        "objects": [],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "EHOUS": {
        "id": "EHOUS",
        "shortDesc": "Behind House",
        "longDesc": "",
        "exits": {
            "NORTH": "NHOUS",
            "SOUTH": "SHOUS",
            "EAST": "CLEAR",
            "WEST": {
                "condition": "\"KITCHEN-WINDOW\"",
                "destination": "KITCH",
                "message": "You can't go that way."
            },
            "ENTER": {
                "condition": "\"KITCHEN-WINDOW\"",
                "destination": "KITCH",
                "message": "You can't go that way."
            }
        },
        "objects": [
            "WIND1"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "KITCH": {
        "id": "KITCH",
        "shortDesc": "Kitchen",
        "longDesc": "",
        "exits": {
            "EAST": {
                "condition": "\"KITCHEN-WINDOW\"",
                "destination": "EHOUS",
                "message": "You can't go that way."
            },
            "WEST": "LROOM",
            "EXIT": {
                "condition": "\"KITCHEN-WINDOW\"",
                "destination": "EHOUS",
                "message": "You can't go that way."
            },
            "UP": "ATTIC",
            "DOWN": {
                "blocked": "Only Santa Claus climbs down chimneys."
            }
        },
        "objects": [
            "WIND2",
            "SBAG",
            "BOTTL"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "ATTIC": {
        "id": "ATTIC",
        "shortDesc": "Attic",
        "longDesc": "You are in the attic.  The only exit is stairs that lead down.",
        "exits": {
            "DOWN": "KITCH"
        },
        "objects": [
            "BRICK",
            "ROPE",
            "KNIFE"
        ],
        "flags": 0,
        "properties": []
    },
    "LROOM": {
        "id": "LROOM",
        "shortDesc": "Living Room",
        "longDesc": "",
        "exits": {
            "EAST": "KITCH",
            "WEST": {
                "condition": "\"MAGIC-FLAG\"",
                "destination": "BLROO",
                "message": "The door is nailed shut."
            },
            "DOWN": {
                "condition": "\"TRAP-DOOR\"",
                "destination": "CELLA",
                "message": "You can't go that way."
            }
        },
        "objects": [
            "WDOOR",
            "DOOR",
            "TCASE",
            "LAMP",
            "RUG",
            "PAPER",
            "SWORD"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "CELLA": {
        "id": "CELLA",
        "shortDesc": "Cellar",
        "longDesc": "You are in the cellar.",
        "exits": {
            "EAST": "MTROL",
            "SOUTH": "CHAS2",
            "UP": {
                "condition": "\"TRAP-DOOR\"",
                "destination": "LROOM",
                "message": "The trap door has been barred from the other side."
            },
            "WEST": {
                "blocked": "You try to ascend the ramp, but it is impossible, and you slide back down."
            }
        },
        "objects": [
            "TDOOR"
        ],
        "flags": 0,
        "properties": []
    },
    "MTROL": {
        "id": "MTROL",
        "shortDesc": "The Troll Room",
        "longDesc": "You are in a small room with passages off in all directions. \nBloodstains and deep scratches (perhaps made by an axe) mar the\nwalls.",
        "exits": {
            "WEST": "CELLA",
            "EAST": {
                "condition": "\"TROLL-FLAG\"",
                "destination": "CRAW4",
                "message": "The troll is blocking your way."
            },
            "NORTH": {
                "condition": "\"TROLL-FLAG\"",
                "destination": "PASS1",
                "message": "The troll is blocking your way."
            },
            "SOUTH": {
                "condition": "\"TROLL-FLAG\"",
                "destination": "MAZE1",
                "message": "The troll is blocking your way."
            }
        },
        "objects": [
            "TROLL"
        ],
        "flags": 0,
        "properties": []
    },
    "MAZE1": {
        "id": "MAZE1",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "WEST": "MTROL",
            "NORTH": "MAZE1",
            "SOUTH": "MAZE2",
            "EAST": "MAZE4"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZE2": {
        "id": "MAZE2",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "SOUTH": "MAZE1",
            "NORTH": "MAZE4",
            "EAST": "MAZE3"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZE3": {
        "id": "MAZE3",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "WEST": "MAZE2",
            "NORTH": "MAZE4",
            "UP": "MAZE5"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZE4": {
        "id": "MAZE4",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "WEST": "MAZE3",
            "NORTH": "MAZE1",
            "EAST": "DEAD1"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "DEAD1": {
        "id": "DEAD1",
        "shortDesc": "Dead End",
        "longDesc": "You are in a dead end.",
        "exits": {
            "SOUTH": "MAZE4"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZE5": {
        "id": "MAZE5",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "EAST": "DEAD2",
            "NORTH": "MAZE3",
            "SW": "MAZE6"
        },
        "objects": [
            "BONES",
            "BAGCO",
            "KEYS",
            "BLANT",
            "RKNIF"
        ],
        "flags": 0,
        "properties": []
    },
    "DEAD2": {
        "id": "DEAD2",
        "shortDesc": "Dead End",
        "longDesc": "You are in a dead end.",
        "exits": {
            "WEST": "MAZE5"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZE6": {
        "id": "MAZE6",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "DOWN": "MAZE5",
            "EAST": "MAZE7",
            "WEST": "MAZE6",
            "UP": "MAZE9"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZE7": {
        "id": "MAZE7",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "UP": "MAZ14",
            "WEST": "MAZE6",
            "NE": "DEAD1",
            "EAST": "MAZE8",
            "SOUTH": "MAZ15"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZE8": {
        "id": "MAZE8",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "NE": "MAZE7",
            "WEST": "MAZE8",
            "SE": "DEAD3"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "DEAD3": {
        "id": "DEAD3",
        "shortDesc": "Dead End",
        "longDesc": "You are in a dead end.",
        "exits": {
            "NORTH": "MAZE8"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZE9": {
        "id": "MAZE9",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "NORTH": "MAZE6",
            "EAST": "MAZ11",
            "DOWN": "MAZ10",
            "SOUTH": "MAZ13",
            "WEST": "MAZ12",
            "NW": "MAZE9"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZ10": {
        "id": "MAZ10",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "EAST": "MAZE9",
            "WEST": "MAZ13",
            "UP": "MAZ11"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZ11": {
        "id": "MAZ11",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "NE": "MGRAT",
            "DOWN": "MAZ10",
            "NW": "MAZ13",
            "SW": "MAZ12"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MGRAT": {
        "id": "MGRAT",
        "shortDesc": "Grating Room",
        "longDesc": "You are in the Grating Room.",
        "exits": {
            "SW": "MAZ11",
            "UP": {
                "condition": "\"GRATING-UNLOCKED\"",
                "destination": "CLEAR",
                "message": "The grating is locked"
            }
        },
        "objects": [
            "GRAT2"
        ],
        "flags": 0,
        "properties": []
    },
    "MAZ12": {
        "id": "MAZ12",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "WEST": "MAZE5",
            "SW": "MAZ11",
            "EAST": "MAZ13",
            "UP": "MAZE9",
            "NORTH": "DEAD4"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "DEAD4": {
        "id": "DEAD4",
        "shortDesc": "Dead End",
        "longDesc": "You are in a dead end.",
        "exits": {
            "SOUTH": "MAZ12"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZ13": {
        "id": "MAZ13",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "EAST": "MAZE9",
            "DOWN": "MAZ12",
            "SOUTH": "MAZ10",
            "WEST": "MAZ11"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZ14": {
        "id": "MAZ14",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "WEST": "MAZ15",
            "NW": "MAZ14",
            "NE": "MAZE7",
            "SOUTH": "MAZE7"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MAZ15": {
        "id": "MAZ15",
        "shortDesc": "Maze",
        "longDesc": "You are in a maze of twisty little passages, all alike.",
        "exits": {
            "WEST": "MAZ14",
            "SOUTH": "MAZE7",
            "NE": "CYCLO"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "FORE1": {
        "id": "FORE1",
        "shortDesc": "",
        "longDesc": "",
        "exits": {
            "NORTH": "FORE1",
            "EAST": "FORE3",
            "SOUTH": "FORE2",
            "WEST": "FORE1"
        },
        "objects": [],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "FORE4": {
        "id": "FORE4",
        "shortDesc": "",
        "longDesc": "You are in a large forest, with trees obstructing all views except\nto the east, where a small clearing may be seen through the trees.",
        "exits": {
            "EAST": "CLTOP",
            "NORTH": "FORE5",
            "SOUTH": "FORE4",
            "WEST": "FORE2"
        },
        "objects": [],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "FORE5": {
        "id": "FORE5",
        "shortDesc": "",
        "longDesc": "",
        "exits": {
            "NORTH": "FORE5",
            "SE": "CLTOP",
            "SOUTH": "FORE4",
            "WEST": "FORE2"
        },
        "objects": [],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "FORE2": {
        "id": "FORE2",
        "shortDesc": "",
        "longDesc": "",
        "exits": {
            "NORTH": "SHOUS",
            "EAST": "CLEAR",
            "SOUTH": "FORE4",
            "WEST": "FORE1"
        },
        "objects": [],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "FORE3": {
        "id": "FORE3",
        "shortDesc": "",
        "longDesc": "",
        "exits": {
            "NORTH": "FORE2",
            "EAST": "CLEAR",
            "SOUTH": "CLEAR",
            "WEST": "NHOUS"
        },
        "objects": [],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "CLEAR": {
        "id": "CLEAR",
        "shortDesc": "Clearing",
        "longDesc": "",
        "exits": {
            "SW": "EHOUS",
            "SE": "FORE5",
            "NORTH": "CLEAR",
            "EAST": "CLEAR",
            "WEST": "FORE3",
            "SOUTH": "FORE2",
            "DOWN": {
                "condition": "\"KEY-FLAG\"",
                "destination": "MGRAT",
                "message": "You can't go that way."
            }
        },
        "objects": [
            "GRAT1",
            "LEAVE"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "RAVI1": {
        "id": "RAVI1",
        "shortDesc": "Deep Ravine",
        "longDesc": "You are in a deep ravine at a crossing with an east-west crawlway. \nSome stone steps are at the south of the ravine and a steep staircase\ndescends.",
        "exits": {
            "SOUTH": "PASS1",
            "DOWN": "RESES",
            "EAST": "CHAS1",
            "WEST": "CRAW1"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "CRAW1": {
        "id": "CRAW1",
        "shortDesc": "Rocky Crawl",
        "longDesc": "You are in a crawlway with a three-foot high ceiling.  Your footing\nis very unsure here due to the assortment of rocks underfoot. \nPassages can be seen in the east, west, and northwest corners of the\npassage.",
        "exits": {
            "WEST": "RAVI1",
            "EAST": "DOME",
            "NW": "EGYPT"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "RESES": {
        "id": "RESES",
        "shortDesc": "Reservoir South",
        "longDesc": "",
        "exits": {
            "SOUTH": {
                "condition": "\"EGYPT-FLAG\"",
                "destination": "RAVI1",
                "message": "The coffin will not fit through this passage."
            },
            "WEST": "STREA",
            "CROSS": {
                "condition": "\"LOW-TIDE\"",
                "destination": "RESEN",
                "message": "You are not equipped for swimming."
            },
            "NORTH": {
                "condition": "\"LOW-TIDE\"",
                "destination": "RESEN",
                "message": "You are not equipped for swimming."
            },
            "UP": {
                "condition": "\"EGYPT-FLAG\"",
                "destination": "CANY1",
                "message": "The stairs are too steep for carrying the coffin."
            }
        },
        "objects": [
            "TRUNK"
        ],
        "flags": 0,
        "properties": []
    },
    "RESEN": {
        "id": "RESEN",
        "shortDesc": "Reservoir North",
        "longDesc": "",
        "exits": {
            "NORTH": "ATLAN",
            "CROSS": {
                "condition": "\"LOW-TIDE\"",
                "destination": "RESES",
                "message": "You are not equipped for swimming."
            },
            "SOUTH": {
                "condition": "\"LOW-TIDE\"",
                "destination": "RESES",
                "message": "You are not equipped for swimming."
            }
        },
        "objects": [
            "PUMP"
        ],
        "flags": 0,
        "properties": []
    },
    "STREA": {
        "id": "STREA",
        "shortDesc": "Stream",
        "longDesc": "You are standing on a path beside a flowing stream.  The path\ntravels to the north and the east.",
        "exits": {
            "EAST": "RESES",
            "NORTH": "ICY"
        },
        "objects": [
            "FUSE"
        ],
        "flags": 0,
        "properties": []
    },
    "EGYPT": {
        "id": "EGYPT",
        "shortDesc": "Egyptian Room",
        "longDesc": "You are in a room which looks like an Egyptian tomb.  There is an\nascending staircase in the room as well as doors, east and south.",
        "exits": {
            "UP": "ICY",
            "SOUTH": "LEDG3",
            "EAST": {
                "condition": "\"EGYPT-FLAG\"",
                "destination": "CRAW1",
                "message": "The passage is too narrow to accomodate coffins."
            }
        },
        "objects": [
            "COFFI"
        ],
        "flags": 0,
        "properties": []
    },
    "ICY": {
        "id": "ICY",
        "shortDesc": "Glacier Room",
        "longDesc": "",
        "exits": {
            "NORTH": "STREA",
            "EAST": "EGYPT",
            "WEST": {
                "condition": "\"GLACIER-FLAG\"",
                "destination": "RUBYR",
                "message": "You can't go that way."
            }
        },
        "objects": [
            "ICE"
        ],
        "flags": 0,
        "properties": []
    },
    "RUBYR": {
        "id": "RUBYR",
        "shortDesc": "Ruby Room",
        "longDesc": "You are in a small chamber behind the remains of the Great Glacier.\nTo the south and west are small passageways.",
        "exits": {
            "WEST": "LAVA",
            "SOUTH": "ICY"
        },
        "objects": [
            "RUBY"
        ],
        "flags": 0,
        "properties": []
    },
    "ATLAN": {
        "id": "ATLAN",
        "shortDesc": "Atlantis Room",
        "longDesc": "You are in an ancient room, long buried by the Reservoir.  There are\nexits here to the southeast and upward.",
        "exits": {
            "SE": "RESEN",
            "UP": "CAVE1"
        },
        "objects": [
            "TRIDE"
        ],
        "flags": 0,
        "properties": []
    },
    "CANY1": {
        "id": "CANY1",
        "shortDesc": "Deep Canyon",
        "longDesc": "You are on the south edge of a deep canyon.  Passages lead off\nto the east, south, and northwest.  You can hear the sound of\nflowing water below.",
        "exits": {
            "NW": "RESES",
            "EAST": "DAM",
            "SOUTH": "CAROU"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "ECHO": {
        "id": "ECHO",
        "shortDesc": "Loud Room",
        "longDesc": "You are in a large room with a ceiling which cannot be detected from\nthe ground. There is a narrow passage from east to west and a stone\nstairway leading upward.  The room is extremely noisy.  In fact, it is\ndifficult to hear yourself think.",
        "exits": {
            "EAST": "CHAS3",
            "WEST": "PASS5",
            "UP": "CAVE3"
        },
        "objects": [
            "BAR"
        ],
        "flags": 0,
        "properties": []
    },
    "MIRR1": {
        "id": "MIRR1",
        "shortDesc": "Mirror Room",
        "longDesc": "",
        "exits": {
            "WEST": "PASS3",
            "NORTH": "CRAW2",
            "EAST": "CAVE1"
        },
        "objects": [
            "REFL1"
        ],
        "flags": 0,
        "properties": []
    },
    "MIRR2": {
        "id": "MIRR2",
        "shortDesc": "Mirror Room",
        "longDesc": "",
        "exits": {
            "WEST": "PASS4",
            "NORTH": "CRAW3",
            "EAST": "CAVE2"
        },
        "objects": [
            "REFL2"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "CAVE1": {
        "id": "CAVE1",
        "shortDesc": "Cave",
        "longDesc": "You are in a small cave with an entrance to the north and a stairway\nleading down.",
        "exits": {
            "NORTH": "MIRR1",
            "DOWN": "ATLAN"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "CAVE2": {
        "id": "CAVE2",
        "shortDesc": "Cave",
        "longDesc": "You are in a tiny cave with entrances west and north, and a dark,\nforbidding staircase leading down.",
        "exits": {
            "NORTH": "CRAW3",
            "WEST": "MIRR2",
            "DOWN": "LLD1"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "CRAW2": {
        "id": "CRAW2",
        "shortDesc": "Steep Crawlway",
        "longDesc": "You are in a steep and narrow crawlway.  There are two exits nearby to\nthe south and southwest.",
        "exits": {
            "SOUTH": "MIRR1",
            "SW": "PASS3"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "CRAW3": {
        "id": "CRAW3",
        "shortDesc": "Narrow Crawlway",
        "longDesc": "You are in a narrow crawlway.  The crawlway leads from north to south.\nHowever the south passage divides to the south and southwest.",
        "exits": {
            "SOUTH": "CAVE2",
            "SW": "MIRR2",
            "NORTH": "MGRAI"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "PASS3": {
        "id": "PASS3",
        "shortDesc": "Cold Passage",
        "longDesc": "You are in a cold and damp corridor where a long east-west passageway\nintersects with a northward path.",
        "exits": {
            "EAST": "MIRR1",
            "WEST": "SLIDE",
            "NORTH": "CRAW2"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "PASS4": {
        "id": "PASS4",
        "shortDesc": "Winding Passage",
        "longDesc": "You are in a winding passage.  It seems that there is only an exit\non the east end although the whirring from the round room can be\nheard faintly to the north.",
        "exits": {
            "EAST": "MIRR2",
            "NORTH": {
                "blocked": "You hear the whir of the carousel room but can find no entrance."
            }
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "SLIDE": {
        "id": "SLIDE",
        "shortDesc": "Slide Room",
        "longDesc": "You are in a small chamber, which appears to have been part of a\ncoal mine. On the south wall of the chamber the letters \\Granite\nWall\\ are etched in the rock. To the east is a long passage and\nthere is a steep metal slide twisting downward. From the appearance\nof the slide, an attempt to climb up it would be impossible.  To the\nnorth is a small opening.",
        "exits": {
            "EAST": "PASS3",
            "DOWN": "CELLA",
            "NORTH": "ENTRA"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "ENTRA": {
        "id": "ENTRA",
        "shortDesc": "Mine Entrance",
        "longDesc": "You are standing at the entrance of what might have been a coal\nmine. To the northeast and the northwest are entrances to the mine,\nand there is another exit on the south end of the room.",
        "exits": {
            "SOUTH": "SLIDE",
            "NW": "SQUEE",
            "NE": "TSHAF"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "SQUEE": {
        "id": "SQUEE",
        "shortDesc": "Squeaky Room",
        "longDesc": "You are a small room.  Strange squeaky sounds may be heard coming from\nthe passage at the west end.  You may also escape to the south.",
        "exits": {
            "WEST": "BATS",
            "SOUTH": "ENTRA"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "TSHAF": {
        "id": "TSHAF",
        "shortDesc": "Shaft Room",
        "longDesc": "You are in a large room, in the middle of which is a small shaft\ndescending through the floor into darkness below.  To the west and\nthe north are exits from this room.  Constructed over the top of the\nshaft is a metal framework to which a heavy iron chain is attached.",
        "exits": {
            "DOWN": {
                "blocked": "You wouldn't fit and would die if you could."
            },
            "WEST": "ENTRA",
            "NORTH": "TUNNE"
        },
        "objects": [
            "TBASK"
        ],
        "flags": 0,
        "properties": []
    },
    "TUNNE": {
        "id": "TUNNE",
        "shortDesc": "Wooden Tunnel",
        "longDesc": "You are in a narrow tunnel with large wooden beams running across\nthe ceiling and around the walls.  A path from the south splits into\npaths running west and northeast.",
        "exits": {
            "SOUTH": "TSHAF",
            "WEST": "SMELL",
            "NE": "MINE1"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "SMELL": {
        "id": "SMELL",
        "shortDesc": "Smelly Room",
        "longDesc": "You are in a small non-descript room.  However, from the direction\nof a small descending staircase a foul odor can be detected.  To the\neast is a narrow path.",
        "exits": {
            "DOWN": "BOOM",
            "EAST": "TUNNE"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "BOOM": {
        "id": "BOOM",
        "shortDesc": "Gas Room",
        "longDesc": "You are in a small room which smells strongly of coal gas.",
        "exits": {
            "UP": "SMELL"
        },
        "objects": [
            "BRACE"
        ],
        "flags": 0,
        "properties": []
    },
    "TLADD": {
        "id": "TLADD",
        "shortDesc": "Ladder Top",
        "longDesc": "You are in a very small room.  In the corner is a rickety wooden\nladder, leading downward.  It might be safe to descend.  There is\nalso a staircase leading upward.",
        "exits": {
            "DOWN": "BLADD",
            "UP": "MINE7"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MINE1": {
        "id": "MINE1",
        "shortDesc": "",
        "longDesc": "",
        "exits": {
            "NORTH": "MINE4",
            "SW": "MINE2",
            "EAST": "TUNNE"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MINE2": {
        "id": "MINE2",
        "shortDesc": "",
        "longDesc": "",
        "exits": {
            "SOUTH": "MINE1",
            "WEST": "MINE5",
            "UP": "MINE3",
            "NE": "MINE4"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MINE3": {
        "id": "MINE3",
        "shortDesc": "",
        "longDesc": "",
        "exits": {
            "WEST": "MINE2",
            "NE": "MINE5",
            "EAST": "MINE5"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MINE4": {
        "id": "MINE4",
        "shortDesc": "",
        "longDesc": "",
        "exits": {
            "UP": "MINE5",
            "NE": "MINE6",
            "SOUTH": "MINE1",
            "WEST": "MINE2"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MINE5": {
        "id": "MINE5",
        "shortDesc": "",
        "longDesc": "",
        "exits": {
            "DOWN": "MINE6",
            "NORTH": "MINE7",
            "WEST": "MINE2",
            "SOUTH": "MINE3",
            "UP": "MINE3",
            "EAST": "MINE4"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MINE6": {
        "id": "MINE6",
        "shortDesc": "",
        "longDesc": "",
        "exits": {
            "SE": "MINE4",
            "UP": "MINE5",
            "NW": "MINE7"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "MINE7": {
        "id": "MINE7",
        "shortDesc": "",
        "longDesc": "",
        "exits": {
            "EAST": "MINE1",
            "WEST": "MINE5",
            "DOWN": "TLADD",
            "SOUTH": "MINE6"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "BLADD": {
        "id": "BLADD",
        "shortDesc": "Ladder Bottom",
        "longDesc": "You are in a rather wide room.  On one side is the bottom of a\nnarrow wooden ladder.  To the northeast and the south are passages\nleaving the room.",
        "exits": {
            "NE": "DEAD7",
            "SOUTH": "TIMBE",
            "UP": "TLADD"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "DEAD7": {
        "id": "DEAD7",
        "shortDesc": "Dead End",
        "longDesc": "Dead End",
        "exits": {
            "SOUTH": "BLADD"
        },
        "objects": [
            "COAL"
        ],
        "flags": 0,
        "properties": []
    },
    "TIMBE": {
        "id": "TIMBE",
        "shortDesc": "Timber Room",
        "longDesc": "You are in a long and narrow passage, which is cluttered with broken\ntimbers.  A wide passage comes from the north and turns at the \nsouthwest corner of the room into a very narrow passageway.",
        "exits": {
            "NORTH": "BLADD",
            "SW": {
                "condition": "\"EMPTY-HANDED\"",
                "destination": "BSHAF",
                "message": "You can't go that way."
            }
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "BSHAF": {
        "id": "BSHAF",
        "shortDesc": "Lower Shaft",
        "longDesc": "You are in a small square room which is at the bottom of a long\nshaft. To the east is a passageway and to the northeast a very narrow\npassage. In the shaft can be seen a heavy iron chain.",
        "exits": {
            "EAST": "MACHI",
            "OUT": {
                "condition": "\"EMPTY-HANDED\"",
                "destination": "TIMBE",
                "message": "You can't go that way."
            },
            "NE": {
                "condition": "\"EMPTY-HANDED\"",
                "destination": "TIMBE",
                "message": "You can't go that way."
            },
            "UP": {
                "blocked": "Not a chance."
            },
            "CLIMB": {
                "blocked": "The chain is not climbable."
            }
        },
        "objects": [
            "FBASK"
        ],
        "flags": 0,
        "properties": []
    },
    "MACHI": {
        "id": "MACHI",
        "shortDesc": "Machine Room",
        "longDesc": "",
        "exits": {
            "NW": "BSHAF"
        },
        "objects": [
            "MSWIT",
            "MACHI"
        ],
        "flags": 0,
        "properties": []
    },
    "BATS": {
        "id": "BATS",
        "shortDesc": "Bat Room",
        "longDesc": "",
        "exits": {
            "EAST": "SQUEE"
        },
        "objects": [
            "JADE",
            "BAT"
        ],
        "flags": 0,
        "properties": []
    },
    "DOME": {
        "id": "DOME",
        "shortDesc": "Dome Room",
        "longDesc": "",
        "exits": {
            "EAST": "CRAW1",
            "DOWN": {
                "condition": "\"DOME-FLAG\"",
                "destination": "MTORC",
                "message": "You cannot go down without fracturing many bones."
            },
            "CLIMB": {
                "condition": "\"DOME-FLAG\"",
                "destination": "MTORC",
                "message": "You cannot go down without fracturing many bones."
            }
        },
        "objects": [
            "RAILI"
        ],
        "flags": 0,
        "properties": []
    },
    "MTORC": {
        "id": "MTORC",
        "shortDesc": "Torch Room",
        "longDesc": "",
        "exits": {
            "UP": {
                "blocked": "You cannot reach the rope."
            },
            "WEST": "MTORC",
            "DOWN": "CRAW4"
        },
        "objects": [
            "TORCH"
        ],
        "flags": 0,
        "properties": []
    },
    "CRAW4": {
        "id": "CRAW4",
        "shortDesc": "North-South Crawlway",
        "longDesc": "You are in a north-south crawlway; a passage goes to the east also.\nThere is a hole above, but it provides no opportunities for climbing.",
        "exits": {
            "NORTH": "CHAS2",
            "SOUTH": "STUDI",
            "EAST": "MTROL",
            "UP": {
                "blocked": "Not even a human fly could get up it."
            }
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "CHAS2": {
        "id": "CHAS2",
        "shortDesc": "West of Chasm",
        "longDesc": "You are on the west edge of a chasm, the bottom of which cannot be\nseen. The east side is sheer rock, providing no exits.  A narrow\npassage goes west, and the path you are on continues to the north and\nsouth.",
        "exits": {
            "WEST": "CELLA",
            "NORTH": "CRAW4",
            "SOUTH": "GALLE",
            "DOWN": {
                "blocked": "The chasm probably leads straight to the infernal regions."
            }
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "CAROU": {
        "id": "CAROU",
        "shortDesc": "Round room",
        "longDesc": "",
        "exits": {
            "NORTH": {
                "condition": "\"CAROUSEL-FLIP\"",
                "destination": "CAVE4",
                "message": ""
            },
            "SOUTH": {
                "condition": "\"CAROUSEL-FLIP\"",
                "destination": "CAVE4",
                "message": ""
            },
            "EAST": {
                "condition": "\"CAROUSEL-FLIP\"",
                "destination": "MGRAI",
                "message": ""
            },
            "WEST": {
                "condition": "\"CAROUSEL-FLIP\"",
                "destination": "PASS1",
                "message": ""
            },
            "NW": {
                "condition": "\"CAROUSEL-FLIP\"",
                "destination": "CANY1",
                "message": ""
            },
            "NE": {
                "condition": "\"CAROUSEL-FLIP\"",
                "destination": "PASS5",
                "message": ""
            },
            "SE": {
                "condition": "\"CAROUSEL-FLIP\"",
                "destination": "PASS4",
                "message": ""
            },
            "SW": {
                "condition": "\"CAROUSEL-FLIP\"",
                "destination": "MAZE1",
                "message": ""
            },
            "EXIT": {
                "condition": "\"CAROUSEL-FLIP\"",
                "destination": "PASS3",
                "message": ""
            }
        },
        "objects": [
            "IRBOX"
        ],
        "flags": 0,
        "properties": []
    },
    "PASS5": {
        "id": "PASS5",
        "shortDesc": "North-South Passage",
        "longDesc": "You are in a high north-south passage, which forks to the northeast.",
        "exits": {
            "NORTH": "CHAS1",
            "NE": "ECHO",
            "SOUTH": "CAROU"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "CHAS1": {
        "id": "CHAS1",
        "shortDesc": "Chasm",
        "longDesc": "A chasm runs southwest to northeast.  You are on the south edge; the\npath exits to the south and to the east.",
        "exits": {
            "SOUTH": "RAVI1",
            "EAST": "PASS5",
            "DOWN": {
                "blocked": "Are you out of your mind?"
            }
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "CAVE3": {
        "id": "CAVE3",
        "shortDesc": "Damp Cave",
        "longDesc": "You are in a cave.  Passages exit to the south and to the east, but\nthe cave narrows to a crack to the west.  The earth is particularly\ndamp here.",
        "exits": {
            "SOUTH": "ECHO",
            "EAST": "DAM",
            "WEST": {
                "blocked": "It is too narrow for most insects."
            }
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "CHAS3": {
        "id": "CHAS3",
        "shortDesc": "Ancient Chasm",
        "longDesc": "A chasm, evidently produced by an ancient river, runs through the\ncave here.  Passages lead off in all directions.",
        "exits": {
            "SOUTH": "ECHO",
            "EAST": "TCAVE",
            "NORTH": "DEAD5",
            "WEST": "DEAD6"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "DEAD5": {
        "id": "DEAD5",
        "shortDesc": "Dead end",
        "longDesc": "Dead end",
        "exits": {
            "SW": "CHAS3"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "DEAD6": {
        "id": "DEAD6",
        "shortDesc": "Dead end",
        "longDesc": "Dead end",
        "exits": {
            "EAST": "CHAS3"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "CAVE4": {
        "id": "CAVE4",
        "shortDesc": "Engravings Cave",
        "longDesc": "You have entered a cave with passages leading north and southeast.",
        "exits": {
            "NORTH": "CAROU",
            "SE": "RIDDL"
        },
        "objects": [
            "ENGRA"
        ],
        "flags": 0,
        "properties": []
    },
    "RIDDL": {
        "id": "RIDDL",
        "shortDesc": "Riddle Room",
        "longDesc": "This is a room which is bare on all sides.  There is an exit down. \nTo the east is a great door made of stone.  Above the stone, the\nfollowing words are written: 'No man shall enter this room without\nsolving this riddle:\n  What is tall as a house,\n\t  round as a cup, \n\t  and all the king's horses can't draw it up?'",
        "exits": {
            "DOWN": "CAVE4",
            "EAST": {
                "condition": "\"RIDDLE-FLAG\"",
                "destination": "MPEAR",
                "message": "Your way is blocked by an invisible force."
            }
        },
        "objects": [
            "SDOOR"
        ],
        "flags": 0,
        "properties": []
    },
    "MPEAR": {
        "id": "MPEAR",
        "shortDesc": "Pearl Room",
        "longDesc": "This is a former broom closet.  The exits are to the east and west.",
        "exits": {
            "EAST": "BWELL",
            "WEST": "RIDDL"
        },
        "objects": [
            "PEARL"
        ],
        "flags": 0,
        "properties": []
    },
    "LLD1": {
        "id": "LLD1",
        "shortDesc": "Entrance to Hades",
        "longDesc": "",
        "exits": {
            "EAST": {
                "condition": "\"LLD-FLAG\"",
                "destination": "LLD2",
                "message": "Some invisible force prevents you from passing through the gate."
            },
            "UP": "CAVE2",
            "ENTER": {
                "condition": "\"LLD-FLAG\"",
                "destination": "LLD2",
                "message": "Some invisible force prevents you from passing through the gate."
            }
        },
        "objects": [
            "CORPS",
            "GATES",
            "GHOST"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "LLD2": {
        "id": "LLD2",
        "shortDesc": "Land of the Living Dead",
        "longDesc": "",
        "exits": {
            "EAST": "TOMB",
            "EXIT": "LLD1",
            "WEST": "LLD1"
        },
        "objects": [
            "BODIE"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "MGRAI": {
        "id": "MGRAI",
        "shortDesc": "Grail Room",
        "longDesc": "You are standing in a small circular room with a pedestal.  A set of\nstairs leads up, and passages leave to the east and west.",
        "exits": {
            "WEST": "CAROU",
            "EAST": "CRAW3",
            "UP": "TEMP1"
        },
        "objects": [
            "GRAIL"
        ],
        "flags": 0,
        "properties": []
    },
    "TEMP1": {
        "id": "TEMP1",
        "shortDesc": "Temple",
        "longDesc": "You are in the west end of a large temple.  On the south wall is an \nancient inscription, probably a prayer in a long-forgotten language. \nThe north wall is solid granite.  The entrance at the west end of the\nroom is through huge marble pillars.",
        "exits": {
            "WEST": "MGRAI",
            "EAST": "TEMP2"
        },
        "objects": [
            "PRAYE",
            "BELL"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "TEMP2": {
        "id": "TEMP2",
        "shortDesc": "Altar",
        "longDesc": "You are in the east end of a large temple.  In front of you is what\nappears to be an altar.",
        "exits": {
            "WEST": "TEMP1"
        },
        "objects": [
            "BOOK",
            "CANDL"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "DAM": {
        "id": "DAM",
        "shortDesc": "Dam",
        "longDesc": "",
        "exits": {
            "SOUTH": "CANY1",
            "DOWN": "DOCK",
            "EAST": "CAVE3",
            "NORTH": "LOBBY"
        },
        "objects": [
            "BOLT",
            "DAM",
            "BUBBL"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "LOBBY": {
        "id": "LOBBY",
        "shortDesc": "Dam Lobby",
        "longDesc": "This room appears to have been the waiting room for groups touring\nthe dam.  There are exits here to the north and east marked\n'Private', though the doors are open, and an exit to the south.",
        "exits": {
            "SOUTH": "DAM",
            "NORTH": "MAINT",
            "EAST": "MAINT"
        },
        "objects": [
            "MATCH",
            "GUIDE"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "MAINT": {
        "id": "MAINT",
        "shortDesc": "Maintenance Room",
        "longDesc": "You are in what appears to have been the maintenance room for Flood\nControl Dam #3, judging by the assortment of tool chests around the\nroom.  Apparently, this room has been ransacked recently, for most of\nthe valuable equipment is gone. On the wall in front of you is a\npanel of buttons, which are labelled in EBCDIC. However, they are of\ndifferent colors:  Blue, Yellow, Brown, and Red. The doors to this\nroom are in the west and south ends.",
        "exits": {
            "SOUTH": "LOBBY",
            "WEST": "LOBBY"
        },
        "objects": [
            "LEAK",
            "TUBE",
            "WRENC",
            "BLBUT",
            "RBUTT",
            "BRBUT",
            "YBUTT",
            "SCREW"
        ],
        "flags": 0,
        "properties": []
    },
    "CYCLO": {
        "id": "CYCLO",
        "shortDesc": "Cyclops Room",
        "longDesc": "",
        "exits": {
            "WEST": "MAZ15",
            "NORTH": {
                "condition": "\"MAGIC-FLAG\"",
                "destination": "BLROO",
                "message": "The north wall is solid rock."
            },
            "UP": {
                "condition": "\"CYCLOPS-FLAG\"",
                "destination": "TREAS",
                "message": "The cyclops doesn't look like he'll let you past."
            }
        },
        "objects": [
            "CYCLO"
        ],
        "flags": 0,
        "properties": []
    },
    "BLROO": {
        "id": "BLROO",
        "shortDesc": "Strange Passage",
        "longDesc": "You are in a long passage.  To the south is one entrance.  On the\neast there is an old wooden door, with a large hole in it (about\ncyclops sized).",
        "exits": {
            "SOUTH": "CYCLO",
            "EAST": "LROOM"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "TREAS": {
        "id": "TREAS",
        "shortDesc": "Treasure Room",
        "longDesc": "This is a large room, whose north wall is solid granite.  A number\nof discarded bags, which crumble at your touch, are scattered about\non the floor.",
        "exits": {
            "DOWN": "CYCLO"
        },
        "objects": [
            "CHALI"
        ],
        "flags": 0,
        "properties": []
    },
    "STUDI": {
        "id": "STUDI",
        "shortDesc": "Studio",
        "longDesc": "You are in what appears to have been an artist's studio.  The walls\nand floors are splattered with paints of 69 different colors. \nStrangely enough, nothing of value is hanging here.  At the north and\nnorthwest of the room are open doors (also covered with paint).  An\nextremely dark and narrow chimney leads up from a fireplace; although\nyou might be able to get up it, it seems unlikely you could get back\ndown.",
        "exits": {
            "NORTH": "CRAW4",
            "NW": "GALLE",
            "UP": {
                "condition": "\"LIGHT-LOAD\"",
                "destination": "KITCH",
                "message": "The chimney is too narrow for you and all of your baggage."
            }
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "GALLE": {
        "id": "GALLE",
        "shortDesc": "Gallery",
        "longDesc": "You are in an art gallery.  Most of the paintings which were here\nhave been stolen by vandals with exceptional taste.  The vandals\nleft through either the north or south exits.",
        "exits": {
            "NORTH": "CHAS2",
            "SOUTH": "STUDI"
        },
        "objects": [
            "PAINT"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "DOCK": {
        "id": "DOCK",
        "shortDesc": "Dam Base",
        "longDesc": "You are at the base of Flood Control Dam #3, which looms above you\nand to the north.  The river Frigid is flowing by here.  Across the\nriver are the White Cliffs which seem to form a giant wall stretching\nfrom north to south along the east shore of the river as it winds its\nway downstream.",
        "exits": {
            "NORTH": "DAM",
            "UP": "DAM",
            "LAUNC": "RIVR1"
        },
        "objects": [
            "IBOAT",
            "STICK"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "RIVR1": {
        "id": "RIVR1",
        "shortDesc": "",
        "longDesc": "You are on the River Frigid in the vicinity of the Dam.  The river\nflows quietly here.  There is a landing on the west shore.",
        "exits": {
            "CURRENT": "WEST",
            "DOCK": "DOWN",
            "RIVR2": "EAST",
            ",": "CLIFFS"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "RIVR2": {
        "id": "RIVR2",
        "shortDesc": "",
        "longDesc": "The River turns a corner here making it impossible to see the\nDam.  The White Cliffs loom on the east bank and large rocks prevent\nlanding on the west.",
        "exits": {
            "CURRENT": "DOWN",
            "RIVR3": "EAST",
            ",": "CLIFFS"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "RIVR3": {
        "id": "RIVR3",
        "shortDesc": "",
        "longDesc": "The river descends here into a valley.  There is a narrow beach on\nthe east below the cliffs and there is some shore on the west which\nmay be suitable.  In the distance a faint rumbling can be heard.",
        "exits": {
            "CURRENT": "DOWN",
            "RIVR4": "EAST",
            "WCLF1": "WEST",
            "RCAVE": "LAND"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "WCLF1": {
        "id": "WCLF1",
        "shortDesc": "White Cliffs Beach",
        "longDesc": "You are on a narrow strip of beach which runs along the base of the\nWhite Cliffs. The only path here is a narrow one, heading south\nalong the Cliffs.",
        "exits": {
            "SOUTH": {
                "condition": "\"DEFLATE\"",
                "destination": "WCLF2",
                "message": "You can't go that way."
            },
            "LAUNC": "RIVR3"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "WCLF2": {
        "id": "WCLF2",
        "shortDesc": "White Cliffs Beach",
        "longDesc": "You are on a rocky, narrow strip of beach beside the Cliffs.  A\nnarrow path leads north along the shore.",
        "exits": {
            "NORTH": {
                "condition": "\"DEFLATE\"",
                "destination": "WCLF1",
                "message": "You can't go that way."
            },
            "LAUNC": "RIVR4"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "RIVR4": {
        "id": "RIVR4",
        "shortDesc": "",
        "longDesc": "The river is running faster here and the sound ahead appears to be\nthat of rushing water.  On the west shore is a sandy beach.  A small\narea of beach can also be seen below the Cliffs.",
        "exits": {
            "CURRENT": "DOWN",
            "RIVR5": "EAST",
            "WCLF2": "WEST",
            "BEACH": "LAND"
        },
        "objects": [
            "BUOY"
        ],
        "flags": 0,
        "properties": []
    },
    "RIVR5": {
        "id": "RIVR5",
        "shortDesc": "",
        "longDesc": "The sound of rushing water is nearly unbearable here.  On the west\nshore is a large landing area.",
        "exits": {
            "CURRENT": "DOWN",
            "FCHMP": "LAND"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "FCHMP": {
        "id": "FCHMP",
        "shortDesc": "Moby lossage",
        "longDesc": "",
        "exits": {
            "NORTH": {
                "blocked": ""
            }
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "FANTE": {
        "id": "FANTE",
        "shortDesc": "Shore",
        "longDesc": "You are on the shore of the River.  The river here seems somewhat\ntreacherous.  A path travels from north to south here, the south end\nquickly turning around a sharp corner.",
        "exits": {
            "LAUNC": "RIVR5",
            "NORTH": "BEACH",
            "SOUTH": "FALLS"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "BEACH": {
        "id": "BEACH",
        "shortDesc": "Sandy Beach",
        "longDesc": "You are on a large sandy beach at the shore of the river, which is\nflowing quickly by.  A path runs beside the river to the south here.",
        "exits": {
            "LAUNC": "RIVR4",
            "SOUTH": "FANTE"
        },
        "objects": [
            "STATU"
        ],
        "flags": 0,
        "properties": []
    },
    "RCAVE": {
        "id": "RCAVE",
        "shortDesc": "Rocky Shore",
        "longDesc": "You are on the west shore of the river.  An entrance to a cave is\nto the northwest.  The shore is very rocky here.",
        "exits": {
            "LAUNC": "RIVR3",
            "NW": "TCAVE"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "TCAVE": {
        "id": "TCAVE",
        "shortDesc": "Small Cave",
        "longDesc": "You are in a small cave whose exits are on the south and northwest.",
        "exits": {
            "SOUTH": "RCAVE",
            "NW": "CHAS3"
        },
        "objects": [
            "GUANO",
            "SHOVE"
        ],
        "flags": 0,
        "properties": []
    },
    "BARRE": {
        "id": "BARRE",
        "shortDesc": "Barrel",
        "longDesc": "You are in a barrel.  Congratulations.  Etched into the side of the\nbarrel is the word 'Geronimo!'.",
        "exits": {
            "EXIT": "FALLS"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "FALLS": {
        "id": "FALLS",
        "shortDesc": "Aragain Falls",
        "longDesc": "",
        "exits": {
            "EAST": {
                "condition": "\"RAINBOW\"",
                "destination": "RAINB",
                "message": "You can't go that way."
            },
            "DOWN": "FCHMP",
            "NORTH": "FANTE",
            "ENTER": "BARRE",
            "UP": {
                "condition": "\"RAINBOW\"",
                "destination": "RAINB",
                "message": "You can't go that way."
            }
        },
        "objects": [
            "RAINB",
            "BARRE"
        ],
        "flags": 0,
        "properties": []
    },
    "RAINB": {
        "id": "RAINB",
        "shortDesc": "Rainbow Room",
        "longDesc": "You are on top of a rainbow (I bet you never thought you would walk\non a rainbow), with a magnificent view of the Falls.  The rainbow\ntravels east-west here.  There is an NBC Commissary here.",
        "exits": {
            "EAST": "POG",
            "WEST": "FALLS"
        },
        "objects": [],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "POG": {
        "id": "POG",
        "shortDesc": "End of Rainbow",
        "longDesc": "You are on a small beach on the continuation of the Frigid River\npast the Falls.  The beach is narrow due to the presence of the White\nCliffs.  The river canyon opens here and sunlight shines in from\nabove. A rainbow crosses over the falls to the west and a narrow path\ncontinues to the southeast.",
        "exits": {
            "CRAIN": "SE",
            ",": "CRAIN"
        },
        "objects": [
            "RAINB",
            "POT"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "CLBOT": {
        "id": "CLBOT",
        "shortDesc": "Canyon Bottom",
        "longDesc": "You are beneath the walls of the river canyon which may be climbable\nhere.  There is a small stream here, which is the lesser part of the\nrunoff of Aragain Falls. To the north is a narrow path.",
        "exits": {
            "UP": "CLMID",
            "CLIMB": "CLMID",
            "NORTH": "POG"
        },
        "objects": [],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "CLMID": {
        "id": "CLMID",
        "shortDesc": "Rocky Ledge",
        "longDesc": "You are on a ledge about halfway up the wall of the river canyon.\nYou can see from here that the main flow from Aragain Falls twists\nalong a passage which it is impossible to enter.  Below you is the\ncanyon bottom.  Above you is more cliff, which still appears\nclimbable.",
        "exits": {
            "UP": "CLTOP",
            "CLIMB": "CLTOP",
            "DOWN": "CLBOT"
        },
        "objects": [],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "CLTOP": {
        "id": "CLTOP",
        "shortDesc": "Canyon View",
        "longDesc": "You are at the top of the Great Canyon on its south wall.  From here\nthere is a marvelous view of the Canyon and parts of the Frigid River\nupstream.  Across the canyon, the walls of the White Cliffs still\nappear to loom far above.  Following the Canyon upstream (north and\nnorthwest), Aragain Falls may be seen, complete with rainbow. \nFortunately, my vision is better than average and I can discern the\ntop of the Flood Control Dam #3 far to the distant north.  To the\nwest and south can be seen an immense forest, stretching for miles\naround.  It is possible to climb down into the canyon from here.",
        "exits": {
            "DOWN": "CLMID",
            "CLIMB": "CLMID",
            "SOUTH": "FORE4",
            "WEST": "FORE5"
        },
        "objects": [],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "VLBOT": {
        "id": "VLBOT",
        "shortDesc": "Volcano Bottom",
        "longDesc": "You are at the bottom of a large dormant volcano.  High above you\nlight may be seen entering from the cone of the volcano.  The only\nexit here is to the north.",
        "exits": {
            "NORTH": "LAVA"
        },
        "objects": [
            "BALLO"
        ],
        "flags": 0,
        "properties": []
    },
    "VAIR1": {
        "id": "VAIR1",
        "shortDesc": "",
        "longDesc": "You are about one hundred feet above the bottom of the volcano.  The\ntop of the volcano is clearly visible here.",
        "exits": {},
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "VAIR2": {
        "id": "VAIR2",
        "shortDesc": "",
        "longDesc": "You are about two hundred feet above the volcano floor.  Looming\nabove is the rim of the volcano.  There is a small ledge on the west\nside.",
        "exits": {
            "WEST": "LEDG2",
            "LAND": "LEDG2"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "VAIR3": {
        "id": "VAIR3",
        "shortDesc": "",
        "longDesc": "You are high above the floor of the volcano.  From here the rim of\nthe volcano looks very narrow and you are very near it.  To the \neast is what appears to be a viewing ledge, too thin to land on.",
        "exits": {},
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "VAIR4": {
        "id": "VAIR4",
        "shortDesc": "",
        "longDesc": "You are near the rim of the volcano which is only about 15 feet\nacross.  To the west, there is a place to land on a wide ledge.",
        "exits": {
            "LAND": "LEDG4",
            "EAST": "LEDG4"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "LEDG2": {
        "id": "LEDG2",
        "shortDesc": "Narrow Ledge",
        "longDesc": "You are on a narrow ledge overlooking the inside of an old dormant\nvolcano.  This ledge appears to be about in the middle between the\nfloor below and the rim above. There is an exit here to the south.",
        "exits": {
            "DOWN": {
                "blocked": "I wouldn't jump from here."
            },
            "LAUNC": "VAIR2",
            "CXGNOME": "SOUTH"
        },
        "objects": [
            "HOOK1",
            "ZORKM"
        ],
        "flags": 0,
        "properties": []
    },
    "LIBRA": {
        "id": "LIBRA",
        "shortDesc": "Library",
        "longDesc": "You are in a room which must have been a large library, probably\nfor the royal family.  All of the shelves appear to have been gnawed\nto pieces by unfriendly gnomes.  To the north is an exit.",
        "exits": {
            "NORTH": "LEDG2",
            "OUT": "LEDG2"
        },
        "objects": [
            "BLBK",
            "GRBK",
            "PUBK",
            "WHBK"
        ],
        "flags": 0,
        "properties": []
    },
    "LEDG3": {
        "id": "LEDG3",
        "shortDesc": "Volcano View",
        "longDesc": "You are on a ledge in the middle of a large volcano.  Below you\nthe volcano bottom can be seen and above is the rim of the volcano.\nA couple of ledges can be seen on the other side of the volcano;\nit appears that this ledge is intermediate in elevation between\nthose on the other side.  The exit from this room is to the east.",
        "exits": {
            "DOWN": {
                "blocked": "I wouldn't try that."
            },
            "CROSS": {
                "blocked": "It is impossible to cross this distance."
            },
            "EAST": "EGYPT"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "LEDG4": {
        "id": "LEDG4",
        "shortDesc": "Wide Ledge",
        "longDesc": "",
        "exits": {
            "DOWN": {
                "blocked": "It's a long way down."
            },
            "LAUNC": "VAIR4",
            "CXGNOME": "SOUTH"
        },
        "objects": [
            "HOOK2"
        ],
        "flags": 0,
        "properties": []
    },
    "SAFE": {
        "id": "SAFE",
        "shortDesc": "Dusty Room",
        "longDesc": "",
        "exits": {
            "NORTH": "LEDG4"
        },
        "objects": [
            "SSLOT",
            "SAFE"
        ],
        "flags": 0,
        "properties": [
            "LIT"
        ]
    },
    "LAVA": {
        "id": "LAVA",
        "shortDesc": "Lava Room",
        "longDesc": "You are in a small room, whose walls are formed by an old lava flow.\nThere are exits here to the west and the south.",
        "exits": {
            "SOUTH": "VLBOT",
            "WEST": "RUBYR"
        },
        "objects": [],
        "flags": 0,
        "properties": []
    },
    "TOMB": {
        "id": "TOMB",
        "shortDesc": "Tomb of the Unknown Implementer",
        "longDesc": "You are in the Tomb of the Unknown Implementer.\nA hollow voice says:  \\That's not a bug, it's a feature!\\",
        "exits": {
            "WEST": "LLD2"
        },
        "objects": [
            "TOMB",
            "HEADS",
            "COKES",
            "LISTS"
        ],
        "flags": 0,
        "properties": []
    },
    "MAGNE": {
        "id": "MAGNE",
        "shortDesc": "Low Room",
        "longDesc": "",
        "exits": {
            "MAGCMACH": "NE",
            ",": "MAGCMACH",
            "MAGALICE": "EAST"
        },
        "objects": [
            "RBTLB",
            "ROBOT"
        ],
        "flags": 0,
        "properties": []
    },
    "CMACH": {
        "id": "CMACH",
        "shortDesc": "Machine Room",
        "longDesc": "",
        "exits": {
            "WEST": "MAGNE",
            "SOUTH": "CAGER"
        },
        "objects": [
            "SQBUT",
            "RNBUT",
            "TRBUT"
        ],
        "flags": 0,
        "properties": []
    },
    "CAGER": {
        "id": "CAGER",
        "shortDesc": "Dingy Closet",
        "longDesc": "You are in a dingy closet adjacent to the machine room.  On one wall\nis a small sticker which says\n\t\tProtected by\n\t\t  FROBOZZ\n\t     Magic Alarm Company\n\t      (Hello, footpad!)\n",
        "exits": {
            "NORTH": "CMACH"
        },
        "objects": [
            "SPHER"
        ],
        "flags": 0,
        "properties": []
    },
    "CAGED": {
        "id": "CAGED",
        "shortDesc": "Cage",
        "longDesc": "You are trapped inside an iron cage.",
        "exits": {
            "NORTH": {
                "blocked": ""
            }
        },
        "objects": [
            "CAGE"
        ],
        "flags": 0,
        "properties": []
    },
    "TWELL": {
        "id": "TWELL",
        "shortDesc": "Top of Well",
        "longDesc": "You are at the top of the well.  Well done.  There are etchings on\nthe side of the well. There is a small crack across the floor at the\nentrance to a room on the east, but it can be crossed easily.",
        "exits": {
            "EAST": "ALICE",
            "DOWN": {
                "blocked": "It's a long way down!"
            }
        },
        "objects": [
            "ETCH2"
        ],
        "flags": 65552,
        "properties": []
    },
    "BWELL": {
        "id": "BWELL",
        "shortDesc": "Circular Room",
        "longDesc": "You are in a damp circular room, whose walls are made of brick and\nmortar.  The roof of this room is not visible, but there appear to be\nsome etchings on the walls.  There is a passageway to the west.",
        "exits": {
            "WEST": "MPEAR",
            "UP": {
                "blocked": "The walls cannot be climbed."
            }
        },
        "objects": [
            "BUCKE",
            "ETCH1"
        ],
        "flags": 65552,
        "properties": []
    },
    "ALICE": {
        "id": "ALICE",
        "shortDesc": "Tea Room",
        "longDesc": "You are in a small square room, in the center of which is a large\noblong table, no doubt set for afternoon tea.  It is clear from the\nobjects on the table that the users were indeed mad.  In the eastern\ncorner of the room is a small hole (no more that four inches high). \nThere are passageways leading away to the west and the northwest.",
        "exits": {
            "EAST": {
                "blocked": "Only a mouse could get in there."
            },
            "WEST": "TWELL",
            "NW": "MAGNE"
        },
        "objects": [
            "ATABL",
            "ECAKE",
            "ORICE",
            "RDICE",
            "BLICE"
        ],
        "flags": 0,
        "properties": []
    },
    "ALISM": {
        "id": "ALISM",
        "shortDesc": "Posts Room",
        "longDesc": "You are in an enormous room, in the center of which are four wooden\nposts delineating a rectanular area, above which is what appears to\nbe a wooden roof.  In fact, all objects in this room appear to be\nabnormally large. To the east is a passageway.  There is a large\nchasm on the west and the northwest.",
        "exits": {
            "SMDROP": "EAST",
            "ALITR": "WEST",
            ",": "SMDROP"
        },
        "objects": [
            "POSTS"
        ],
        "flags": 0,
        "properties": []
    },
    "ALITR": {
        "id": "ALITR",
        "shortDesc": "Pool Room",
        "longDesc": "You are in a large room, one half of which is depressed.  There is a\nlarge leak in the ceiling through which brown colored goop is\nfalling.  The only exit to this room is to the west.",
        "exits": {
            "EXIT": "ALISM",
            "WEST": "ALISM"
        },
        "objects": [
            "FLASK",
            "POOL",
            "SAFFR"
        ],
        "flags": 0,
        "properties": []
    }
};
const vocabularyData = {
    "adjectives": [
        "brown", "nasty", "elvish", "brassy", "broken",
        "bloody",
        "leather",
        "platinum",
        "used", "burned", "dead", "useless",
        "glass",
        "rusty",
        "dented", "iron",
        "fancy",
        "one-eyed", "monstrous",
        "plastic", "with_hole",
        "shiny", "thin",
        "blue", "green", "purple", "white",
        "large",
        "crystal"
    ],
    "buzzwords": [
        "by", "is", "one", "it", "a", "the", "an", "this", "over",
        "of", "in", "on"
    ],
    "prepositions": [
        "with", "at", "to", "in", "on", "under", "into", "down",
        "out", "from", "up", "between", "behind", "through", "beside",
        "onto", "from_within"
    ],
    "verbs": [
        {"id": "ATTACK", "synonyms": ["hit", "fight", "strike", "chop", "kill", "murde", "slay", "dispa"]},
        {"id": "OPEN", "synonyms": ["open"]},
        {"id": "READ", "synonyms": ["skim", "scan"]},
        {"id": "TAKE", "synonyms": ["get", "carry", "pick", "grab"]},
        {"id": "DROP", "synonyms": ["leave", "put", "place"]},
        {"id": "LOOK", "synonyms": ["l", "stare", "gaze", "descr", "what", "whats", "what'"]},
        {"id": "EXAMINE", "synonyms": ["exami", "inspect", "check"]},
        {"id": "GO", "synonyms": ["walk", "run"]},
        {"id": "MOVE", "synonyms": ["push", "pull", "shove", "move"]},
        {"id": "TURN-ON", "synonyms": ["on", "light", "ignit"]},
        {"id": "TURN-OFF", "synonyms": ["off", "extin", "douse"]},
        {"id": "GIVE", "synonyms": ["hand", "donat"]},
        {"id": "PLUG", "synonyms": ["plug"]},
        {"id": "RUB", "synonyms": ["cares", "touch", "fondl"]},
        {"id": "BURN", "synonyms": ["burn", "light"]},
        {"id": "CLOSE", "synonyms": ["close"]},
        {"id": "UNLOCK", "synonyms": ["unloc"]},
        {"id": "LOCK", "synonyms": ["lock"]},
        {"id": "TIE", "synonyms": ["tie"]},
        {"id": "RING", "synonyms": ["ring", "peal"]},
        {"id": "EAT", "synonyms": ["eat"]},
        {"id": "DRINK", "synonyms": ["drink"]},
        {"id": "BRUSH", "synonyms": ["brush"]},
        {"id": "UNTIE", "synonyms": ["untie"]},
        {"id": "THROW", "synonyms": ["throw", "toss"]},
        {"id": "MUNG", "synonyms": ["mung", "break"]},
        {"id": "SAVE", "synonyms": ["save"]},
        {"id": "RESTORE", "synonyms": ["resto"]},
        {"id": "QUIT", "synonyms": ["quit"]},
        {"id": "INVENTORY", "synonyms": ["inven", "list"]},
        {"id": "SCORE", "synonyms": ["score"]},
        {"id": "HELP", "synonyms": ["help", "info"]},
        {"id": "JUMP", "synonyms": ["leap", "vault"]},
        {"id": "ENTER", "synonyms": ["enter"]}
    ],
    "nouns": [
        {"id": "ADVER", "synonyms": ["pamphlet", "leaflet", "booklet"]},
        {"id": "AXE", "synonyms": ["bloody axe"]},
        {"id": "BAGCO", "synonyms": ["bag", "coins", "leather bag"]},
        {"id": "BAR", "synonyms": ["plati", "platinum bar"]},
        {"id": "BELL", "synonyms": ["brass bell"]},
        {"id": "LANTERN", "synonyms": ["lantern", "lamp", "brass lantern"]},
        {"id": "BLANT", "synonyms": ["lantern", "lamp", "burned-out lantern"]},
        {"id": "BOTTLE", "synonyms": ["glass bottle", "conta", "pitch"]},
        {"id": "KNIFE", "synonyms": ["nasty-looking knife"]},
        {"id": "LEAVES", "synonyms": ["pile", "leaves"]},
        {"id": "MAILBOX", "synonyms": ["mail", "box", "small mailbox"]},
        {"id": "NEST", "synonyms": ["egg", "jewel-encrusted egg"]},
        {"id": "ROPE", "synonyms": ["hemp", "coil", "large coil of rope"]},
        {"id": "SACK", "synonyms": ["bag", "leather sack"]},
        {"id": "SWORD", "synonyms": ["orcri", "glamd", "blade", "elvish sword"]},
        {"id": "TROPHY-CASE", "synonyms": ["case", "trophy case"]},
        {"id": "TRAP-DOOR", "synonyms": ["trapdoor", "cover", "trap", "dusty trap door"]},
        {"id": "TROLL", "synonyms": ["nasty-looking troll", "volcano gnome"]},
        {"id": "WATER", "synonyms": ["liqui", "h2o", "quantity of water"]},
        {"id": "WIND1", "synonyms": ["win", "window"]},
        {"id": "HOUSE", "synonyms": ["white house"]},
        {"id": "MAT", "synonyms": ["rubber mat", "welcome mat"]},
        {"id": "FRONT-DOOR", "synonyms": ["door", "front door", "boarded door"]},
        {"id": "RKNIF", "synonyms": ["knife", "rusty knife"]},
        {"id": "GRAT2", "synonyms": ["grating", "grate"]},
        {"id": "ZORKMID", "synonyms": ["zorkm", "coin", "gold coin"]},
        {"id": "SAFE", "synonyms": ["box"]},
        {"id": "CARD", "synonyms": ["note"]},
        {"id": "FUSE", "synonyms": ["coil", "wire", "shiny wire"]},
        {"id": "BALLO", "synonyms": ["basket", "wicker basket"]},
        {"id": "PUMP", "synonyms": ["air-p", "airpu", "hand pump"]},
        {"id": "RBOAT", "synonyms": ["boat", "inflated boat"]},
        {"id": "CROWN", "synonyms": ["jeweled crown", "crown"]},
        {"id": "GRAIL", "synonyms": ["valuable grail", "original grail", "grail"]},
        {"id": "PLATINUM BAR", "synonyms": ["platinum bar"]},
        {"id": "KEYS", "synonyms": ["keys"]},
        {"id": "RUG", "synonyms": ["rug", "carpet"]}
    ],
    "directions": [
        {"id": "DOWN", "synonyms": ["d"]},
        {"id": "EAST", "synonyms": ["e"]},
        {"id": "EXIT", "synonyms": ["out", "leave"]},
        {"id": "NORTH", "synonyms": ["n"]},
        {"id": "SOUTH", "synonyms": ["s"]},
        {"id": "UP", "synonyms": ["u"]},
        {"id": "WEST", "synonyms": ["w"]},
        {"id": "NORTHEAST", "synonyms": ["ne"]},
        {"id": "NORTHWEST", "synonyms": ["nw"]},
        {"id": "SOUTHEAST", "synonyms": ["se"]},
        {"id": "SOUTHWEST", "synonyms": ["sw"]},
        {"id": "CROSS", "synonyms": ["cross"]},
        {"id": "CLIMB", "synonyms": ["climb"]}
    ]
};
const deathMessagesData = {
    "BOMB": "   BOOOOOOOOOOOM      ",
    "RAINBOW": "The structural integrity of the rainbow seems to have left it, leaving you about 450 feet in the air, supported by water vapor.",
    "DROWN": "Unfortunately, that leaves you in the water, where you drown.",
    "FALLS": "Oh dear, you seem to have gone over Aragain Falls.  Not a very smart thing to do, apparently.",
    "GRUE": "It is pitch black. You are likely to be eaten by a grue.",
    "GAS": "You have succumbed to the poison gas!",
    "VAPORS": "Just before you pass out, you notice that the vapors from the flask's contents are fatal.",
    "CRUSHED": "The room seems to have become too small to hold you.  It seems that the walls are not as compressible as your body, which is somewhat demolished.",
    "ICEBLAST": "You have been blasted to smithereens (wherever they are).",
    "POISON": "Time passes...and you die from some obscure poisoning.",
    "TROLL": "The troll's axe removes your head.",
    "THIEF": "The thief's stilletto has found a home in your back.",
    "FALL": "You have fallen from a great height and died.",
    "MACHINE": "A booming voice says 'Wrong, cretin!' and you notice that you have turned into a pile of dust.",
    "CYCLO": "The cyclops, enraged, picks you up and tears you limb from limb.",
    "DEFAULT": "You have died."
};
/* Zork Game Code */
// RBITS: Room flags (Expanded based on MDL sources)
const RBITS = {
    RSEEN: 1 << 0,     // Player has been in the room
    RLIGHT: 1 << 1,    // Room is lit (MDL RLIGHT?)
    RDESC: 1 << 2,     // Room has a long description
    RMAZE: 1 << 3,     // Room is part of a maze
    RBUCK: 1 << 4,     // Player can fill a bucket here (MDL RBUCKBIT)
    RWATER: 1 << 5,    // Room is on/in water
    RFILL: 1 << 6,     // Room can be filled with water (MDL RFILLBIT)
    RHERE: 1 << 7,     // Something is here
    RNWALL: 1 << 8,    // No wall separating from another room
    RSACRD: 1 << 9,    // Sacred room (MDL RSACREDBIT)
    RWIN: 1 << 10,     // Player has won
    RSTRNG: 1 << 11,   // Player is strengthened here
    RART: 1 << 12,     // Room contains an artifact
    RCLIMB: 1 << 13,   // Room can be climbed
    RDIR: 1 << 14,     // Directional room
    NONLAND: 1 << 15,  // Not on land (This appears to be inverted in JS based on MDL RLANDBIT)
    RLAND: 1 << 16,    // Room is on land (MDL RLANDBIT, inverse of NONLAND in JS)
    RHOUSE: 1 << 17,   // Room is part of the house (MDL RHOUSEBIT)
    RDESCBIT: 1 << 18  // Force room description (internal VM flag)
};

// OFLAGS: Object flags (Expanded based on MDL sources)
const OFLAGS = {
    TAKEBIT: 1 << 0,       // Object can be taken
    DOORBIT: 1 << 1,       // Object is a door
    OPENBIT: 1 << 2,       // Object is open (MDL OOPEN?)
    LOCKBIT: 1 << 3,       // Object is locked (Not directly in provided MDL, but implied for doors)
    CONTBIT: 1 << 4,       // Object is a container
    BURNBIT: 1 << 5,       // Object is flammable (MDL BURNBIT)
    WEAPONBIT: 1 << 6,     // Object is a weapon
    READBIT: 1 << 7,       // Object is readable
    SACREDBIT: 1 << 8,     // Object is sacred
    TOOLBIT: 1 << 9,       // Object is a tool
    DRINKBIT: 1 << 10,     // Object is drinkable
    FOODBIT: 1 << 11,      // Object is food (MDL FOODBIT)
    TIEBIT: 1 << 12,       // Object can be tied (MDL TIEBIT)
    VEHBIT: 1 << 13,       // Object is a vehicle
    OVISON: 1 << 14,       // Object is visible (MDL OVISON)
    VILLAIN: 1 << 15,      // Object is a villain (MDL VILLAIN)
    VICBIT: 1 << 16,       // Object is a victim/can be attacked (MDL VICBIT)
    SLEEPBIT: 1 << 17,     // Object can be slept on
    SEARCHBIT: 1 << 18,    // Object can be searched
    CLIMBBIT: 1 << 19,     // Object can be climbed
    SCENERYBIT: 1 << 20,   // Object is scenery
    INVISIBLE: 1 << 21,    // Object is invisible
    DISARMEDBIT: 1 << 22,  // Object is disarmed (e.g., a trap)
    NOTDESCBIT: 1 << 23,   // Object is not described separately (MDL NDESCBIT)
    TRYTAKEBIT: 1 << 24    // Attempt to take object (MDL TRYTAKEBIT)
};


// FBITS: Flag bits (global game state)
const FBITS = {
    // These would be defined based on the 'DEFS.63' file for global flags
    // Example:
    TROLLFLAG: 1 << 0, // Troll is angry
    THIEFFLAG: 1 << 1, // Thief has appeared
};

/**
 * Checks if a specific flag is set in a bitmask.
 * @param {number} bitmask - The bitmask to check.
 * @param {number} flag - The flag to check for.
 * @returns {boolean} - True if the flag is set, false otherwise.
 */
function hasFlag(bitmask, flag) {
    return (bitmask & flag) !== 0;
}

/**
 * Sets a specific flag in a bitmask.
 * @param {number} bitmask - The bitmask to modify.
 * @param {number} flag - The flag to set.
 * @returns {number} - The new bitmask.
 */
function setFlag(bitmask, flag) {
    return bitmask | flag;
}

/**
 * Clears a specific flag in a bitmask.
 * @param {number} bitmask - The bitmask to modify.
 * @param {number} flag - The flag to clear.
 * @returns {number} - The new bitmask.
 */
function clearFlag(bitmask, flag) {
    return bitmask & ~flag;
}


class GameObject {
    constructor(data) {
        this.id = data.id;
        this.name = data.name;
        this.description = data.description;
        this.initialDescription = data.initialDescription;
        this.text = data.text; // Text for readable objects
        this.location = null; // Will be set by the game engine
        this.oflags = data.flags || 0; // Bitmask for OFLAGS, parser uses 'flags'

        // Additional properties from MDL
        this.synonyms = data.synonyms || [];
        this.adjectives = data.adjectives || [];
        this.capacity = data.capacity || 0;
        this.size = data.size || 0;
        this.value = data.value || 0;         // MDL OFVAL
        this.trophyValue = data.trophyValue || 0; // MDL OTVAL
        this.damage = data.damage || 0;       // For weapons (MDL implied by WEAPONBIT)
        this.health = data.health || 0;       // For villains (MDL implied by VICBIT)
        this.contents = data.contents || [];  // Objects contained within this object
        this.canBeContainedBy = data.canBeContainedBy || null; // What can contain this object (MDL OCAN)
        this.action = data.action || null;    // MDL OACTION
        this.trollState = {}; // For troll-specific logic
    }
}

class Room {
    constructor(data) {
        this.id = data.id;
        this.name = data.shortDesc; // Was data.name
        this.description = data.longDesc; // Was data.description
        this.exits = data.exits || {};     // Standard exits
        this.objects = data.objects || []; // IDs of objects initially in the room
        this.rbits = data.rbits || 0;      // Bitmask for RBITS

        // Additional properties derived from MDL, keeping original names for clarity
        this.longDescription = data.longDesc;
        this.shortDescription = data.shortDesc;
        this.action = data.action || null; // MDL RACTION
        this.value = data.value || 0;      // MDL RVAL
    }
}

class Player {
    constructor(data) {
        this.location = data.location;
        this.inventory = new Map(); // Using a map for easier add/remove
        this.score = 0;
        this.moves = 0;
    }
}

function findBestNounMatch(sentence, nouns) {
    let bestMatch = null;

    for (const noun of nouns) {
        const allNames = [noun.id.toLowerCase(), ...(noun.synonyms || []).map(s => s.toLowerCase())];
        for (const name of allNames) {
            if (sentence.includes(name)) {
                // Prioritize longer matches to handle cases like "sandwich bag" vs "bag"
                if (!bestMatch || name.length > bestMatch.matchedName.length) {
                    bestMatch = { ...noun, matchedName: name };
                }
            }
        }
    }
    return bestMatch;
}


function parseCommand(command, vocabulary) {
    const words = command.toLowerCase().split(/\s+/);
    const verbWord = words[0];
    const verb = (vocabulary.verbs || []).find(v => v.id.toLowerCase() === verbWord || (v.synonyms && v.synonyms.map(s => s.toLowerCase()).includes(verbWord)));

    if (!verb) {
        const direction = (vocabulary.directions || []).find(d => d.id.toLowerCase() === verbWord || (d.synonyms && d.synonyms.map(s => s.toLowerCase()).includes(verbWord)));
        if (direction) {
            return { verb: direction.id.toUpperCase() };
        }
        return { error: `I don't know the verb "${verbWord}".` };
    }

    if (words.length === 1) {
        return { verb: verb.id };
    }

    const remainingSentence = words.slice(1).join(' ');
    let dobjString = remainingSentence;
    let iobjString = null;

    // Handle indirect objects (e.g., "attack troll with sword")
    const withKeywords = [' with ', ' using ', ' on '];
    let withIndex = -1;
    let withKeyword = null;

    for(const keyword of withKeywords) {
        const index = remainingSentence.indexOf(keyword);
        if (index !== -1) {
            withIndex = index;
            withKeyword = keyword;
            break;
        }
    }

    if (withIndex !== -1) {
        dobjString = remainingSentence.substring(0, withIndex);
        iobjString = remainingSentence.substring(withIndex + withKeyword.length);
    }

    const dobj = findBestNounMatch(dobjString, vocabulary.nouns);
    const iobj = iobjString ? findBestNounMatch(iobjString, vocabulary.nouns) : null;

    return {
        verb: verb.id,
        dobj: dobj ? dobj.id : null,
        iobj: iobj ? iobj.id : null,
        error: !dobj && dobjString ? `I can't see a "${dobjString.trim()}" here.` : null
    };
}


class Exit {
    constructor({
        direction,
        roomId,
        condition = null, // Can be a flag name (string) or a function
        message = null // Message to show if exit is blocked
    }) {
        this.direction = direction;
        this.roomId = roomId;
        this.condition = condition;
        this.message = message;
    }
}
class UI {
    constructor(terminalElement, inputElement) {
        this.terminalElement = terminalElement;
        this.inputElement = inputElement;
        this.buffer = [];
        this.MAX_LINES = 24;
        this.prompt = '> ';
        this.onInputCallback = null;

        window.addEventListener('click', () => {
            this.inputElement.focus();
        });
        this.terminalElement.addEventListener('wheel', (e) => e.preventDefault());
    }

    render() {
        const displayBuffer = this.buffer.slice(-this.MAX_LINES);

        // Add cursor to the last line for rendering
        if (displayBuffer.length > 0) {
            const lastLineIndex = displayBuffer.length - 1;
            // Create a temporary copy to modify for rendering
            const tempLine = displayBuffer[lastLineIndex];
            displayBuffer[lastLineIndex] = tempLine + '<span class="cursor"></span>';
        }

        this.terminalElement.innerHTML = displayBuffer.join('\n');
        this.terminalElement.scrollTop = this.terminalElement.scrollHeight;
    }

    // For initial game output
    start(initialText) {
        const lines = initialText.split('\n');
        this.buffer.push(...lines);
        this.buffer.push(this.prompt);
        this.render();
    }

    updateInput(text) {
        if (this.buffer.length > 0) {
            // The last line is always the input line
            this.buffer[this.buffer.length - 1] = this.prompt + text;
            this.render();
        }
    }

    onInput(callback) {
        this.onInputCallback = callback;

        this.inputElement.addEventListener('input', () => {
            this.updateInput(this.inputElement.value);
        });

        this.inputElement.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                const command = this.inputElement.value;
                this.inputElement.value = '';

                // 1. Lock the input line into history
                this.buffer[this.buffer.length - 1] = this.prompt + command;

                // 2. Send input to game engine and get output
                const gameOutput = this.onInputCallback(command);

                // 3. Append game response
                if (gameOutput) {
                    const lines = gameOutput.split('\n');
                    // If the last line of output is empty, remove it, as we add our own prompt
                    if (lines.length > 0 && lines[lines.length - 1].trim() === '') {
                        lines.pop();
                    }
                    this.buffer.push(...lines);
                }

                // 4. Finally, append the new prompt for the next input
                this.buffer.push(this.prompt);

                // Trim buffer
                while (this.buffer.length > this.MAX_LINES) {
                    this.buffer.shift();
                }

                this.render();
            }
        });
    }

    // This method is not needed if the logic is handled in onInput
    display() {}
}

function applyAction(action, dobj, iobj, game) {
    const handler = actionHandlers[action.verb];
    if (handler) {
        return handler(dobj, iobj, game, action);
    }
    return "I don't know how to do that.";
}

const actionHandlers = {
    TAKE: (dobj, iobj, game) => {
        if (!dobj) return "What do you want to take?";
        if (dobj.location !== game.player.location) return "You can't see that here.";
        if (hasFlag(dobj.oflags, OFLAGS.TAKEBIT)) {
            dobj.location = 'IN_INVENTORY';
            return `${dobj.name}: Taken.`;
        }
        return `You can't take the ${dobj.name}.`;
    },

    DROP: (dobj, iobj, game) => {
        if (!dobj) return "What do you want to drop?";
        if (dobj.location !== 'IN_INVENTORY') return "You don't have that.";
        dobj.location = game.player.location;
        return "Dropped.";
    },

    LOOK: (dobj, iobj, game) => {
        return game.look();
    },

    GO: (dobj, iobj, game, action) => {
        const room = game.rooms.get(game.player.location);
        const direction = action.verb.replace('GO ', '');
        const exit = room.exits[direction];

        if (!exit) {
            return "You can't go that way.";
        }

        // Handle simple string-based exits
        if (typeof exit === 'string') {
            game.player.location = exit;
            const targetRoom = game.rooms.get(exit);
            targetRoom.rbits = setFlag(targetRoom.rbits, RBITS.RDESCBIT);
            return '';
        }

        // Handle conditional exits (object-based)
        if (typeof exit === 'object' && exit.destination) {
            if (evaluateCondition(exit.condition, game)) {
                game.player.location = exit.destination;
                const targetRoom = game.rooms.get(exit.destination);
                targetRoom.rbits = setFlag(targetRoom.rbits, RBITS.RDESCBIT);
                return '';
            } else {
                return exit.message || "You can't go that way.";
            }
        }

        // Handle blocked exits (object with 'blocked' message)
        if (typeof exit === 'object' && exit.blocked) {
            return exit.blocked;
        }

        return "You can't go that way.";
    },

    EXAMINE: (dobj, iobj, game) => {
        if (!dobj) return "Examine what?";
        if (dobj.location !== game.player.location && dobj.location !== 'IN_INVENTORY') {
            return "You can't see that here.";
        }
        let text = dobj.description || `You see nothing special about the ${dobj.name}.`;
        if (hasFlag(dobj.oflags, OFLAGS.CONTBIT)) {
             const contents = Array.from(game.objects.values()).filter(obj => obj.location === dobj.id);
             if (contents.length > 0) {
                 text += `\nThe ${dobj.name} contains:\n` + contents.map(c => `  ${c.name}`).join('\n');
             } else {
                 text += `\nThe ${dobj.name} is empty.`;
             }
        }
        return text;
    },

    OPEN: (dobj, iobj, game, action) => {
        if (typeof dobj === 'string' && dobj.startsWith('DEBUG:')) return dobj;
        if (dobj && dobj.id === 'FRONT-DOOR') {
            return "The door is boarded and you can't remove the boards.";
        }

        if (!dobj) return "Open what?";

        if (hasFlag(dobj.oflags, OFLAGS.OPENBIT)) {
            return `The ${dobj.name} is already open.`;
        }

        // Generic openable logic for doors and containers
        if (hasFlag(dobj.oflags, OFLAGS.DOORBIT) || hasFlag(dobj.oflags, OFLAGS.CONTBIT)) {
            dobj.oflags = setFlag(dobj.oflags, OFLAGS.OPENBIT);

            // Special response for the mailbox
            if (dobj.id === 'MAILBOX') {
            const leaflet = game.objects.get('ADVER');
                // Check if leaflet is still inside
                if (leaflet && leaflet.location === 'MAILBOX') {
                    return "Opening the small mailbox reveals a leaflet.";
                } else {
                    return `You open the ${dobj.name}.`;
                }
            }

            // Special response for the window
            if (dobj.id === 'WIND1') {
                return 'With great effort, you open the window far enough to allow entry.';
            }

            // Default response for other openable things
            return `The ${dobj.name} is now open.`;
        }

        return `You can't open the ${dobj.name}.`;
    },

    READ: (dobj, iobj, game) => {
        if (!dobj) return "Read what?";

        // The object must be readable
        if (!hasFlag(dobj.oflags, OFLAGS.READBIT)) {
            return "You can't read that.";
        }

        let response = "";
        // Automatically take the object if it's takeable and not in inventory yet
        if (hasFlag(dobj.oflags, OFLAGS.TAKEBIT) && dobj.location !== 'IN_INVENTORY') {
            dobj.location = 'IN_INVENTORY';
            response += "(Taken)\n";
        }

        // Display the text
        if (dobj.text) {
            response += dobj.text;
        } else {
            response += `There is nothing written on the ${dobj.name}.`;
        }

        return response;
    },

    MOVE: (dobj, iobj, game) => {
        if (!dobj) return "Move what?";
        if (dobj.id === 'RUG') {
            if (hasFlag(dobj.oflags, OFLAGS.INVISIBLE)) {
                 return "The rug is already moved.";
            }
            dobj.oflags = setFlag(dobj.oflags, OFLAGS.INVISIBLE); // Hide the rug
            const trapDoor = game.objects.get('TRAP-DOOR');
            trapDoor.oflags = clearFlag(trapDoor.oflags, OFLAGS.INVISIBLE); // Reveal the trap door
            trapDoor.location = game.player.location;
            return "With a great effort, the rug is moved to one side of the room. With the rug moved, the dusty cover of a closed trap door appears.";
        }
        return "You can't move that.";
    },

    ATTACK: (dobj, iobj, game) => {
        if (!dobj || dobj.id !== 'TROLL') return "You can't attack that.";

        const troll = dobj;
        const weapon = iobj || Array.from(game.objects.values()).find(o => o.location === 'IN_INVENTORY' && hasFlag(o.oflags, OFLAGS.WEAPONBIT));

        if (!weapon) {
            return "Attacking the troll with your bare hands is suicidal.";
        }

        if (troll.trollState.hits === undefined) {
            troll.trollState.hits = 0;
        }
        troll.trollState.hits++;

        if (troll.trollState.hits >= 2) {
             troll.trollState.unconscious = true;
             troll.description = "The troll is lying on the ground, unconscious.";
             game.globalFlags.set('TROLL-FLAG', true);
             return "The troll is knocked out!";
        } else {
             return "A furious but glancing blow is struck.\nThe troll's axe barely misses your ear.";
        }
    },

    // Default handlers for motion verbs
    NORTH: (d, i, g, a) => actionHandlers.GO(d, i, g, { ...a, verb: 'GO NORTH' }),
    SOUTH: (d, i, g, a) => actionHandlers.GO(d, i, g, { ...a, verb: 'GO SOUTH' }),
    EAST: (d, i, g, a) => actionHandlers.GO(d, i, g, { ...a, verb: 'GO EAST' }),
    WEST: (d, i, g, a) => actionHandlers.GO(d, i, g, { ...a, verb: 'GO WEST' }),
    UP: (d, i, g, a) => actionHandlers.GO(d, i, g, { ...a, verb: 'GO UP' }),
    DOWN: (d, i, g, a) => actionHandlers.GO(d, i, g, { ...a, verb: 'GO DOWN' }),
    NORTHEAST: (d, i, g, a) => actionHandlers.GO(d, i, g, { ...a, verb: 'GO NE' }),
    NORTHWEST: (d, i, g, a) => actionHandlers.GO(d, i, g, { ...a, verb: 'GO NW' }),
    SOUTHEAST: (d, i, g, a) => actionHandlers.GO(d, i, g, { ...a, verb: 'GO SE' }),
    SOUTHWEST: (d, i, g, a) => actionHandlers.GO(d, i, g, { ...a, verb: 'GO SW' }),
    'TURN-ON': (dobj, iobj, game) => {
        if (!dobj) return "Turn on what?";
        if (dobj.id !== 'LANTERN') return "You can't turn that on.";
        if (hasFlag(dobj.oflags, OFLAGS.LIGHTBIT)) {
            return `The ${dobj.name} is already on.`;
        }
        dobj.oflags = setFlag(dobj.oflags, OFLAGS.LIGHTBIT);
        return `The brass lantern is now on.`;
    },
    'TURN-OFF': (dobj, iobj, game) => {
        if (!dobj) return "Turn off what?";
        if (dobj.id !== 'LANTERN') return "You can't turn that off.";
        if (!hasFlag(dobj.oflags, OFLAGS.LIGHTBIT)) {
            return `The ${dobj.name} is already off.`;
        }
        dobj.oflags = clearFlag(dobj.oflags, OFLAGS.LIGHTBIT);
        return `The ${dobj.name} is now off.`;
    },

    UNLOCK: (dobj, iobj, game) => {
        if (!dobj) return "Unlock what?";
        if (!iobj) return "Unlock it with what?";

        if (dobj.id === 'GRAT2' && iobj.id === 'KEYS') {
            if (!hasFlag(dobj.oflags, OFLAGS.LOCKBIT)) {
                return "The grating is already unlocked.";
            }
            dobj.oflags = clearFlag(dobj.oflags, OFLAGS.LOCKBIT);
            return "The grating is unlocked.";
        }

        return "You can't unlock that.";
    }
};

// Add a generic 'ENTER' handler that maps to GO
actionHandlers.ENTER = (dobj, iobj, game, action) => {
    // In Zork, "enter" is often a synonym for "go" but can be more contextual.
    const room = game.rooms.get(game.player.location);

    // If no direct object, see if there's an obvious thing to enter.
    if (!dobj) {
        // Is there an open window in the room?
        const window = Array.from(game.objects.values()).find(o => o.location === room.id && o.id === 'WIND1');
        if (window && hasFlag(window.oflags, OFLAGS.OPENBIT)) {
            dobj = window;
        }
    }

    // Special case for entering the window
    if (dobj && dobj.id === 'WIND1') {
        if (hasFlag(dobj.oflags, OFLAGS.OPENBIT)) {
            game.player.location = 'KITCH';
            game.rooms.get('KITCH').rbits = setFlag(game.rooms.get('KITCH').rbits, RBITS.RDESCBIT);
            return ''; // Success, triggers a look
        } else {
            return "The window is closed.";
        }
    }

    // Generic enter logic: treat it as GO-ing to a room-like object
    if (dobj && game.rooms.has(dobj.id)) {
         for (const [dir, roomId] of Object.entries(room.exits)) {
            if (roomId === dobj.id) {
                return actionHandlers.GO(null, null, game, { ...action, verb: `GO ${dir}` });
            }
        }
    }

    return "You can't enter that.";
};

function evaluateCondition(condition, game) {
    if (!condition) return true; // No condition means the exit is always open

    const flagName = condition.replace(/\"/g, '');

    // Check for object-based conditions
    switch (flagName) {
        case 'TRAP-DOOR':
            const trapDoor = game.objects.get('TRAP-DOOR');
            return trapDoor && hasFlag(trapDoor.oflags, OFLAGS.OPENBIT);
        case 'KITCHEN-WINDOW':
            const window = game.objects.get('WIND1');
            return window && hasFlag(window.oflags, OFLAGS.OPENBIT);
        case 'GRATING-UNLOCKED': // This is a made-up flag for now
            const grating = game.objects.get('GRAT2');
            return grating && !hasFlag(grating.oflags, OFLAGS.LOCKBIT);
    }

    // Check for global flags
    return game.globalFlags.get(flagName) === true;
}




class Game {
    constructor(data) {
        this.objects = new Map(Object.values(data.objects).map(o => [o.id, new GameObject(o)]));
        this.rooms = new Map(Object.values(data.rooms).map(r => [r.id, new Room(r)]));
        this.player = new Player({ location: 'WHOUS' }); // Starting location
        this.vocabulary = data.vocabulary;
        this.deathMessages = data.deathMessages;
        this.globalFlags = new Map();

        this.initObjectLocations();
    }

    initObjectLocations() {
        console.log('Initializing object locations...');
        // Set initial locations for objects based on room data
        for (const room of this.rooms.values()) {
            if (room.objects) {
                for (const objectId of room.objects) {
                    if (this.objects.has(objectId)) {
                        this.objects.get(objectId).location = room.id;
                        console.log(`Set location of ${objectId} to ${room.id}`);
                    } else {
                        console.log(`Object ${objectId} in room ${room.id} not found in master object list.`);
                    }
                }
            }
        }

        // Set initial locations for objects contained within other objects
        for (const container of this.objects.values()) {
            if (container.contents && container.contents.length > 0) {
                for (const objectId of container.contents) {
                    if (this.objects.has(objectId)) {
                        this.objects.get(objectId).location = container.id;
                    }
                }
            }
        }
    }

    run() {
        // This will be the main game loop, handled by the test runner for now
        // For interactive play, this would involve a read-eval-print loop (REPL)
    }

    tick(command) {
        // 1. Parse the command
        const action = parseCommand(command, this.vocabulary);

        // 2. Resolve direct and indirect objects
        const dobj = action.dobj ? this.findObject(action.dobj) : null;
        const iobj = action.iobj ? this.findObject(action.iobj) : null;

        // 3. Apply the action
        let result = '';
        if (action.verb) {
            result = applyAction(action, dobj, iobj, this);
        } else {
            result = action.error || "I don't understand that command.";
        }


        // 4. Post-action logic (like handling LOOK after movement)
        const currentRoom = this.rooms.get(this.player.location);
        if ((currentRoom.rbits & RBITS.RDESCBIT) !== 0) {
            result = this.look(); // Replace result with room description
            currentRoom.rbits &= ~RBITS.RDESCBIT; // Clear the flag
        }


        return result.trim();
    }

    findObject(objectId) {
        if (!objectId) return null;

        // First, check player's inventory
        let obj = Array.from(this.objects.values()).find(o => o.id === objectId && o.location === 'IN_INVENTORY');
        if (obj) {
            return obj;
        }

        // Then, check the player's current location
        obj = Array.from(this.objects.values()).find(o => o.id === objectId && o.location === this.player.location);
        if (obj) return obj;

        // Finally, check for objects inside OPEN containers in the current room
        const containersInRoom = Array.from(this.objects.values()).filter(o =>
            o.location === this.player.location &&
            hasFlag(o.oflags, OFLAGS.CONTBIT) &&
            hasFlag(o.oflags, OFLAGS.OPENBIT) // Container must be open
        );
        for (const container of containersInRoom) {
             obj = Array.from(this.objects.values()).find(o => o.id === objectId && o.location === container.id);
             if (obj) return obj;
        }

        // If the object is not in scope, it cannot be found.
        return null;
    }

     look() {
        const room = this.rooms.get(this.player.location);
        let description = room.description;

        const objectsInRoom = Array.from(this.objects.values()).filter(
            (obj) => obj.location === room.id &&
                     !hasFlag(obj.oflags, OFLAGS.INVISIBLE) &&
                     !hasFlag(obj.oflags, OFLAGS.NOTDESCBIT)
        );

        // Sort objects based on the order in the room's object list
        objectsInRoom.sort((a, b) => {
            const aIndex = room.objects.indexOf(a.id);
            const bIndex = room.objects.indexOf(b.id);
            return aIndex - bIndex;
        });

        if (objectsInRoom.length > 0) {
            // Use initialDescription if available, otherwise description.
            // This is a simplification of Zork's behavior.
            const objectDescriptions = objectsInRoom.map((obj) => {
                return obj.initialDescription || obj.description;
            }).filter(desc => desc); // Filter out empty descriptions
            if (objectDescriptions.length > 0) {
                 description += '\n' + objectDescriptions.join('\n');
            }
        }
        return description;
    }
}

// Main entry point for the browser-based game.
async function main() {
    // Get references to the DOM elements
    const terminalElement = document.getElementById('terminal');
    const inputElement = document.getElementById('input');

    // Instantiate the UI and Game
    const ui = new UI(terminalElement, inputElement);
    const game = new Game({
        objects: objectsData,
        rooms: roomsData,
        vocabulary: vocabularyData,
        deathMessages: deathMessagesData
    });

    // Set up the input handler. The callback passed to onInput
    // will be executed when the user enters a command. It passes
    // the command to the game's tick function and returns the result.
    ui.onInput((command) => {
        return game.tick(command);
    });

    // Display the initial room description to start the game.
    const initialOutput = game.look();
    ui.start(initialOutput);
}

// Start the game when the DOM is ready
document.addEventListener('DOMContentLoaded', main);
